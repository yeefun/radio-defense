{"version":3,"sources":["boss.js","circle.js","enemy.js","index.js","polygon.js","prop.js","shooter.js","triangle.js","utility.js"],"names":["Boss","args","_classCallCheck","this","def","axisRotateR","axisRotateAngle","rotate","scale","rotateV","bullets","HP","beforeGenerateEnemyTime","Date","beginAppear","isAppearing","axisRotateAngleV","originPos","x","y","isDisappeared","degToPi","appearTimer","disappearTimer","ctx","moveTo","Object","lineTo","closePath","save","fillStyle","beginPath","fill","globalColor","white","red","blue","Math","PI","orange","strokeStyle","lineWidth","arc","stroke","forEach","bullet","appear","idx","arr","appearTimes","gameCrawler","textContent","TweenLite","to","ease","rotateNum","getRandom","concat","update","_this","setTimeout","game","isPause","shoot","easeOut","Expo","onComplete","_this2","playSound","_this3","BossBullet","p","disappear","push","_this4","chooseEnemy","circles","Circle","isBossGenerate","triangles","Triangle","rotateAngle","polygons","Polygon","whole","big","small","num","color","moveX","moveXV","restore","enemyMethods","attackShooter","r","beforeRotateTime","assign","axisRotateRV","isRotating","circleBigR","circleSmallR","subAxisRotateR","cos","sin","$triLineTo","isStart","approach","rotateTime","_loop","timer","CirBullet","clearTimeout","i","Power2","random","Back","config","translate","enemy","_typeof","shooter","cirSolidLineW","isPolygon","shooterBody","seconds","distance","updateFPS","isBoss","arguments","length","undefined","dieTime","effect","dieEffect","colorRGB","shadowBlur","enemyR","baseLog","effectX","effectY","effectR","shadowColor","requestAnimationFrame","hitShooter","enemies","enemyIdx","type","enemyAxisRotateR","enemyAxisRotateAngle","state","abs","mouseMoveAngle","shieldAngleRange","splice","polygonR","judgeWhatEnemyHit","shieldR","shieldLineW","bulletIdx","bulletLen","attackShooterResult","shooterShield","isProtect","bulletRotate","angleGap","currentLevel","boss","shooterHPBar","isAttacked","style","width","shooterHPBarW","hearts","crawlerClearedTimer","playerName","querySelectorAll","shooterHPBarOriginW","removeChild","shooterHeart","bgm","pause","bossDieResult","victoryBgm","endGame","canvas","ww","wh","gameW","updateTime","yellow","blueDark","props","document","getElementById","restartBtn","starsBtn","backBtn","restartBtnStars","cover","gamePanel","batteryInfo","heartWrapper","startBtn","prop","propImg","propLastTime","result","resultBattery","panel","keyboard","gameLevel","resultBullet","resultRanking","resultScore","resultStars","getContext","gameHalfDiagonalL","gameH","initCanvas","round","sqrt","height","documentElement","clientWidth","clientHeight","coverCircle","coverTriangle","coverPolygon","Game","batteryNum","subTris","isEnd","blockV","countdownSeconds","countdownTimer","hpRecoverTimer","countupTimer","propGeneratedTimer","propGeneratedInterval","beatBossSeconds","isDisplayStars","addEventListener","handleMouseMove","handleClick","window","handleKeyup","handlePlayerName","checkPlayerName","startGame","drawCover","render","setBlockV","recoverShooterHPBar","classList","add","remove","handleGameStars","shareFb","open","shareTwitter","encodeURIComponent","drawBlock","name","fillRect","draw","circle","triangle","subTriangle","drawMouse","polygon","Shooter","rotateR","mouseMovePosY","mouseMovePos","mouseMovePosX","_this5","display","value","innerHTML","createElement","appendChild","heart","container","cursor","pointerEvents","gameTime","countdownStartTime","clearCrawler","play","loadingIcon","rankingNum","starWrapper2","starWrapper3","setLevel","resultBoss","bulletNum","handleGameResult","currentTime","volume","level","battery","params","then","res","data","totalPlayers","firstStarData","firstData","secondStarData","secondData","thirdStarData","thirdData","starScoreHTML","fillStarScore","wave","bat","apply","_toConsumableArray","starWrapper1","_this6","propName","Prop","generateProp","_this7","axios","_this8","trueSeconds","TimeMinutes","minutes","TimeSeconds","countupTime","_this9","nowHPW","offsetWidth","recoverHPBarW","_this10","form","_this11","angle","countdownTime","initLevel","setEnemy","handleLoad","init","evt","atan2","beforeShootTime","key","pauseGame","isMuted","muted","isJustSplite","drawLightning","rotateDirection","Circ","rNum","img","Image","src","complete","drawImage","replace","split","outerR","x1","y1","y2","ShooterBullet","waveLength","waveFreq","waveAmp","waveFlow","shootTime","recoverHeart","lastTime","drawCrackdownEffect","displayPropInfo","crackdownTime","countLastTime","propInfoTimer","bodyLen","v","anglePanFn","shotRRangeFn","cirIdx","asin","bulletMoveLen","triIdx","lengthX","lengthY","attackEnemy","polyIdx","sideA","attackPolygon","NaN","beyondBoundary","enemyAnglePan","enemyAngleAdd","shotAngleRange","judgeShotAngleRange","enemyAngleMinus","shotRRange","sideB1Len","sideB2Len","angleAB2","rotateAngleJudge","angleB1","angleB2","polyAxisRotateAngle","polyRotate","sideB1","sideB2","sideC1","cosineFormula","angleAB1","bottomJudge","topJudge","getAngleB","sideC2","polyAngleMinus","polyAngleAdd","shooterRotateAngle","shooterAnglePan","beforeRotateAxisAngleTime","isGeneratedSub","shootTimer","triOuterBigR","triInnerBigR","triInnerSmallR","randomRotateAngle","rotateAxisAngleTime","Power0","easeNone","TriSub","order","TriBullet","isReproduceMoving","Power1","easeIn","drawWaveBullet","degree","log","a","b","c","acos","min","max","floor","instrument","note","synth","duration","timeout","Tone","MembraneSynth","toMaster","triggerAttackRelease","DuoSynth","MonoSynth","Synth","angleAdd"],"mappings":"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","file":"index.js","sourcesContent":["class Boss {\r\n  constructor(args) {\r\n    const def = {\r\n      axisRotateR: 0,\r\n      axisRotateAngle: 0,\r\n      rotate: 0,\r\n      scale: 0,\r\n      // axisRotateRV: 1,\r\n      axisRotateAngleV: 1,\r\n      rotateV: 1,\r\n      bullets: [],\r\n      HP: 24,\r\n      beforeGenerateEnemyTime: new Date(),\r\n      beginAppear: true,\r\n      isAppearing: false,\r\n      isDisappeared: false,\r\n      appearTimes: 0,\r\n      appearTimer: null,\r\n      disappearTimer: null,\r\n    }\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n  draw() {\r\n    ctx.save();\r\n      ctx.translate(originPos(this.axisRotateR, this.axisRotateAngle).x, originPos(this.axisRotateR, this.axisRotateAngle).y);\r\n      ctx.scale(this.scale, this.scale);\r\n      ctx.rotate(this.rotate * degToPi);\r\n      // 透明頭\r\n      ctx.fillStyle = 'rgba(255, 255, 255, 0.4)';\r\n      ctx.beginPath();\r\n      ctx.moveTo(0, 0);\r\n      ctx.lineTo(11, 0);\r\n      ctx.lineTo(18, 6);\r\n      ctx.lineTo(18, 15);\r\n      ctx.lineTo(-18, 15);\r\n      ctx.lineTo(-18, 6);\r\n      ctx.lineTo(-11, 0);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n      // 黃頭\r\n      ctx.fillStyle = globalColor.orange;\r\n      ctx.beginPath();\r\n      ctx.moveTo(0, 9);\r\n      ctx.lineTo(11, 9);\r\n      ctx.lineTo(18, 15);\r\n      ctx.lineTo(18, 36);\r\n      ctx.lineTo(-18, 36);\r\n      ctx.lineTo(-18, 15);\r\n      ctx.lineTo(-11, 9);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n      // 裝飾內透明頭\r\n      ctx.fillStyle = 'rgba(255, 255, 255, 0.25)';\r\n      ctx.beginPath();\r\n      ctx.moveTo(0, 9 + 8);\r\n      ctx.lineTo(4, 9 + 8);\r\n      ctx.lineTo(14, 24);\r\n      ctx.lineTo(14, 36 - 8);\r\n      ctx.lineTo(-14, 36 - 8);\r\n      ctx.lineTo(-14, 24);\r\n      ctx.lineTo(-4, 9 + 8);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n      // 右白肩\r\n      ctx.fillStyle = globalColor.white;\r\n      ctx.beginPath();\r\n      ctx.moveTo(18, -6);\r\n      ctx.lineTo(18 + 8, -6);\r\n      ctx.lineTo(18 + 8 + 8, 15);\r\n      ctx.lineTo(18 + 8 + 8, 36 + 6);\r\n      ctx.lineTo(18, 36 + 6);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n      // 左白肩\r\n      ctx.fillStyle = globalColor.white;\r\n      ctx.beginPath();\r\n      ctx.moveTo(-18, -6);\r\n      ctx.lineTo(-18 - 8, -6);\r\n      ctx.lineTo(-18 - 8 - 8, 15);\r\n      ctx.lineTo(-18 - 8 - 8, 36 + 6);\r\n      ctx.lineTo(-18, 36 + 6);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n      // 右紅翼\r\n      ctx.fillStyle = globalColor.red;\r\n      ctx.beginPath();\r\n      ctx.moveTo(18 + 8 + 8, 9);\r\n      ctx.lineTo(18 + 8 + 8 + 8, 9);\r\n      ctx.lineTo(18 + 8 + 8 + 8 + 16, 36 + 6);\r\n      ctx.lineTo(18 + 8 + 8 + 8 + 16, 36 + 6 + 8);\r\n      ctx.lineTo(18 + 8 + 8, 36 + 6 + 8);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n      // 左藍翼\r\n      ctx.fillStyle = globalColor.blue;\r\n      ctx.beginPath();\r\n      ctx.moveTo(-18 - 8 - 8 + 4, 9);\r\n      ctx.lineTo(-18 - 8 - 8 - 8 + 4, 9);\r\n      ctx.lineTo(-18 - 8 - 8 - 8 - 16 + 4, 36 + 6);\r\n      ctx.lineTo(-18 - 8 - 8 - 8 - 16 + 4, 36 + 6 + 8);\r\n      ctx.lineTo(-18 - 8 - 8 + 4, 36 + 6 + 8);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n      // 右灰風口\r\n      ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';\r\n      ctx.beginPath();\r\n      ctx.moveTo(18 + 8 + 8, 36 + 6 + 8);\r\n      ctx.lineTo(18 + 8 + 8, 36 + 6 + 8 + 6);\r\n      ctx.lineTo(18 + 8 + 8 + 16, 36 + 6 + 8 + 6);\r\n      ctx.lineTo(18 + 8 + 8 + 16, 36 + 6 + 8);\r\n      ctx.fill();\r\n      // 左灰風口\r\n      ctx.beginPath();\r\n      ctx.moveTo(-18 - 8 - 8 + 4, 36 + 6 + 8);\r\n      ctx.lineTo(-18 - 8 - 8 + 4, 36 + 6 + 8 + 6);\r\n      ctx.lineTo(-18 - 8 - 8 - 16 + 4, 36 + 6 + 8 + 6);\r\n      ctx.lineTo(-18 - 8 - 8 - 16 + 4, 36 + 6 + 8);\r\n      ctx.fill();\r\n      // 右裝飾白圈\r\n      ctx.strokeStyle = globalColor.white;\r\n      ctx.lineWidth = 2.8;\r\n      ctx.beginPath();\r\n      ctx.arc(18 + 8 + 8 + 11, 36 + 6 - 2, 4.4, 0, Math.PI * 2);\r\n      ctx.stroke();\r\n      // 左裝飾黃叉\r\n      ctx.strokeStyle = globalColor.orange;\r\n      // ctx.lineWidth = 2.8;\r\n      ctx.beginPath();\r\n      ctx.moveTo(-18 - 8 - 8 + 4 - 3.2, 9 + 16);\r\n      ctx.lineTo(-18 - 8 - 8 + 4 - 3.2 - 9.6, 9 + 16 + 9.6);\r\n      ctx.moveTo(-18 - 8 - 8 + 4 - 3.2 - 9.6, 9 + 16);\r\n      ctx.lineTo(-18 - 8 - 8 + 4 - 3.2, 9 + 16 + 9.6);\r\n      ctx.stroke();\r\n      // 左裝飾透明四邊形\r\n      ctx.fillStyle = 'rgba(255, 255, 255, 0.24)';\r\n      ctx.beginPath();\r\n      ctx.moveTo(-18 - 8 - 8 - 8 - 16 + 4 + 4, 36 + 6 - 8.25);\r\n      ctx.lineTo(-18 - 8 - 8 - 8 - 16 + 4, 36 + 6);\r\n      ctx.lineTo(-18 - 8 - 8 - 8 - 16 + 4, 36 + 6 + 8);\r\n      ctx.lineTo(-18 - 8 - 8 - 6 + 4, 36 + 6 + 8);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n    ctx.restore();\r\n    // 繪製 boss 子彈\r\n    this.bullets.forEach((bullet) => {\r\n      bullet.draw();\r\n    });\r\n  }\r\n  update() {\r\n    // boss 出現\r\n    this.beginAppear && this.appear();\r\n    this.beginAppear = false;\r\n    if (!this.isAppearing && !this.isDisappeared) {\r\n    }\r\n    // 更新 boss 子彈\r\n    this.bullets.forEach((bullet, idx, arr) => {\r\n      bullet.update(idx, arr);\r\n    });\r\n  }\r\n  appear() {\r\n    if (game.isEnd) return;\r\n    this.appearTimes += 1;\r\n    this.isDisappeared = false;\r\n    this.isAppearing = true;\r\n    gameCrawler.textContent = '⚠ BOSS IS COMING';\r\n    TweenLite.to(this, 1.2, {\r\n      scale: 1,\r\n      ease: Expo.easeOut,\r\n    });\r\n    const rotateNum = getRandom(45, 135);\r\n    TweenLite.to(this, 1.6, {\r\n      axisRotateAngle: `+=${rotateNum}`,\r\n      rotate: `+=${rotateNum}`,\r\n      ease: Expo.easeOut,\r\n      onComplete: () => {\r\n        this.isAppearing = false;\r\n      },\r\n    });\r\n    if (this.appearTimes && this.appearTimes % 3) {\r\n      setTimeout(() => {\r\n        if (this.HP === 0 || game.isPause) return;\r\n        this.shoot();\r\n      }, 2000);\r\n    } else {\r\n      setTimeout(() => {\r\n        if (this.HP === 0 || game.isPause) return;\r\n        this.generateEnemy();\r\n      }, 2000);\r\n    }\r\n    this.disappearTimer = setTimeout(() => {\r\n      if (this.HP === 0 || game.isPause) return;\r\n      this.disappear();\r\n    }, 4000);\r\n    playSound('membrane', 'A4', '4n');\r\n  }\r\n  disappear() {\r\n    if (game.isEnd) return;\r\n    this.isDisappeared = true;\r\n    TweenLite.to(this, 1.2, {\r\n      scale: 0,\r\n      ease: Expo.easeOut,\r\n    });\r\n    const rotateNum = getRandom(45, 225);\r\n    TweenLite.to(this, 1.6, {\r\n      axisRotateAngle: `+=${rotateNum}`,\r\n      rotate: `+=${rotateNum}`,\r\n      ease: Expo.easeOut,\r\n    });\r\n    this.appearTimer = setTimeout(() => {\r\n      if (this.HP === 0 || game.isPause) return;\r\n      this.appear();\r\n    }, 2000);\r\n    playSound('membrane', 'F3', '4n');\r\n  }\r\n  shoot() {\r\n    this.bullets.push(new BossBullet({\r\n      p: {\r\n        x: originPos(this.axisRotateR, this.axisRotateAngle).x,\r\n        y: originPos(this.axisRotateR, this.axisRotateAngle).y,\r\n      },\r\n      rotateAngle: this.rotate,\r\n      axisRotateR: this.axisRotateR,\r\n    }));\r\n    playSound('mono', 'F2', '4n', 0, -10);\r\n    setTimeout(() => {\r\n      this.bullets.push(new BossBullet({\r\n        p: {\r\n          x: originPos(this.axisRotateR, this.axisRotateAngle).x,\r\n          y: originPos(this.axisRotateR, this.axisRotateAngle).y,\r\n        },\r\n        rotateAngle: this.rotate,\r\n        waveLength: 14,\r\n        axisRotateR: this.axisRotateR,\r\n      }));\r\n      playSound('mono', 'F2', '4n', 0, -10);\r\n    }, 200);\r\n  }\r\n  generateEnemy() {\r\n    let num;\r\n    const chooseEnemy = () => {\r\n      num = getRandom(1, 3);\r\n      switch (num) {\r\n        case 1:\r\n          game.circles.push(new Circle({\r\n            axisRotateR: this.axisRotateR,\r\n            axisRotateAngle: this.axisRotateAngle % 360,\r\n            axisRotateAngleV: -(getRandom(2, 8) / 10),\r\n            rotate: getRandom(0, 360),\r\n            isBossGenerate: true,\r\n          }));\r\n          break;\r\n        case 2:\r\n          game.triangles.push(new Triangle({\r\n            axisRotateR: this.axisRotateR,\r\n            axisRotateAngle: this.axisRotateAngle % 360,\r\n            axisRotateAngleV: getRandom(2, 8) / 10,\r\n            rotate: this.axisRotateAngle % 360,\r\n            isBossGenerate: true,\r\n          }));\r\n          break;\r\n        case 3:\r\n          const rotate = getRandom(0, 360);\r\n          game.polygons.push(new Polygon({\r\n            axisRotateR: {\r\n              whole: this.axisRotateR,\r\n              big: this.axisRotateR,\r\n              small: this.axisRotateR,\r\n            },\r\n            axisRotateAngle: {\r\n              whole: this.axisRotateAngle % 360,\r\n              big: this.axisRotateAngle % 360,\r\n              small: this.axisRotateAngle % 360,\r\n            },\r\n            rotate: {\r\n              whole: rotate,\r\n              big: rotate,\r\n              small: rotate,\r\n            },\r\n            rotateV: getRandom(4, 8) / 10,\r\n            isBossGenerate: true,\r\n          }));\r\n          break;\r\n        default:\r\n          break;\r\n      }\r\n    }\r\n    chooseEnemy();\r\n    if (Math.random() >= 0.5) {\r\n      setTimeout(() => {\r\n        chooseEnemy();\r\n      }, 400);\r\n    }\r\n  }\r\n}\r\n\r\nclass BossBullet {\r\n  constructor(args) {\r\n    const def = {\r\n      p: {\r\n        x: 0,\r\n        y: 0,\r\n      },\r\n      axisRotateR: 0,\r\n      color: globalColor.orange,\r\n      moveX: 8,\r\n      moveXV: 4,\r\n      rotateAngle: 0,\r\n      waveLength: 22,\r\n      waveFreq: 0.3,\r\n      waveAmp: 4,\r\n      waveFlow: 3,\r\n      isBoss: true,\r\n    }\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n  draw() {\r\n    ctx.save();\r\n      ctx.translate(this.p.x, this.p.y);\r\n      ctx.rotate((this.rotateAngle - 90) * degToPi);\r\n      // 開始畫 boss 子彈\r\n      drawWaveBullet(this, 'moveX', 2.4, 'rgba(245, 175, 95, 0.72)');\r\n    ctx.restore();\r\n  }\r\n  update(idx, arr) {\r\n    // boss 子彈移動\r\n    this.moveX += this.moveXV;\r\n    enemyMethods.attackShooter(this, idx, arr);\r\n  }\r\n}","class Circle {\r\n  constructor(args) {\r\n    const def = {\r\n      axisRotateR: 0,\r\n      axisRotateAngle: 0,\r\n      r: 22,\r\n      rotate: 0,\r\n      scale: 0,\r\n      axisRotateRV: 0,\r\n      axisRotateAngleV: 0,\r\n      // rotateV: 0,\r\n      color: globalColor.orange,\r\n      HP: 2,\r\n      bullets: [],\r\n      beforeRotateTime: new Date(),\r\n      isRotating: false,\r\n      beginAppear: true,\r\n      isBossGenerate: false,\r\n    }\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n\r\n\r\n  draw() {\r\n    const circleBigR = this.r + 5;\r\n    const circleSmallR = this.r - 10;\r\n    const subAxisRotateR = 14;\r\n    ctx.save();\r\n    ctx.translate(originPos(this.axisRotateR, this.axisRotateAngle).x, originPos(this.axisRotateR, this.axisRotateAngle).y);\r\n    ctx.rotate(this.rotate * degToPi);\r\n    ctx.scale(this.scale, this.scale);\r\n    // 大淡圓\r\n    ctx.beginPath();\r\n    ctx.arc(4, 0, circleBigR, 0, Math.PI * 2);\r\n    ctx.fillStyle = 'rgba(245, 175, 95, 0.21)';\r\n    ctx.fill();\r\n    // 小淡圓\r\n    ctx.beginPath();\r\n    ctx.arc(-20, 0, circleSmallR, 0, Math.PI * 2);\r\n    ctx.fillStyle = 'rgba(245, 175, 95, 0.21)';\r\n    ctx.fill();\r\n    // 主體圓\r\n    ctx.beginPath();\r\n    ctx.arc(0, 0, this.r, 0, Math.PI * 2);\r\n    ctx.fillStyle = this.color;\r\n    ctx.fill();\r\n    // 小三圓\r\n    ctx.beginPath();\r\n    ctx.fillStyle = globalColor.white;\r\n    // ctx.arc(subAxisRotateR, 0, 2.4, 0, Math.PI * 2);\r\n    ctx.arc(subAxisRotateR * Math.cos(60 * degToPi), subAxisRotateR * Math.sin(60 * degToPi), 2.4, 0, Math.PI * 2);\r\n    ctx.fill();\r\n    ctx.beginPath();\r\n    ctx.arc(subAxisRotateR * Math.cos(180 * degToPi), subAxisRotateR * Math.sin(180 * degToPi), 2.4, 0, Math.PI * 2);\r\n    ctx.fill();\r\n    ctx.beginPath();\r\n    ctx.arc(subAxisRotateR * Math.cos(300 * degToPi), subAxisRotateR * Math.sin(300 * degToPi), 2.4, 0, Math.PI * 2);\r\n    ctx.fill();\r\n    // 神經\r\n    ctx.beginPath();\r\n    ctx.fillStyle = globalColor.white;\r\n    ctx.lineTo(-8, 0);\r\n    ctx.$triLineTo(-2, 32);\r\n    ctx.$triLineTo(-12, 120);\r\n    ctx.$triLineTo(-2.4, 176);\r\n    ctx.$triLineTo(-8, 240);\r\n    ctx.$triLineTo(-1.6, 320);\r\n    ctx.closePath();\r\n    ctx.fill();\r\n    ctx.restore();\r\n    // 繪製圓形子彈\r\n    this.bullets.forEach((bullet) => {\r\n      bullet.draw();\r\n    });\r\n  }\r\n\r\n\r\n  update(idx) {\r\n    this.beginAppear && this.appear(this.isBossGenerate);\r\n    this.beginAppear = false;\r\n    game.isStart && enemyMethods.approach(this);\r\n    // 更新圓形子彈\r\n    this.bullets.forEach((bullet, idx, arr) => {\r\n      bullet.update(idx, arr);\r\n    });\r\n    // 當圓形自身在旋轉時，圓形不要移動\r\n    if (!this.isRotating) {\r\n      this.axisRotateAngle += this.axisRotateAngleV;\r\n    }\r\n    // 每 4-8 秒，自身旋轉一次\r\n    const rotateTime = new Date();\r\n    if ((rotateTime - this.beforeRotateTime) > getRandom(4000, 8000)) {\r\n      this.isRotating = true;\r\n      TweenLite.to(this, 0.4, {\r\n        // rotate: this.axisRotateAngle - 180,\r\n        // rotate: this.axisRotateAngle % 360,\r\n        rotate: this.axisRotateAngle,\r\n        ease: Power2.easeOut,\r\n        // 自身旋轉完後射擊\r\n        onComplete: () => {\r\n          this.isRotating = false;\r\n          if (!game.isStart) return;\r\n          this.shoot();\r\n        },\r\n      });\r\n      this.beforeRotateTime = rotateTime;\r\n    }\r\n    // 當圓形撞上 shooter\r\n    enemyMethods.hitShooter(game.circles, idx, 'circle', this.axisRotateR, this.axisRotateAngle);\r\n  }\r\n\r\n\r\n  shoot() {\r\n    // 射 1-2 發\r\n    for (let i = 0; i < getRandom(1, 2); i += 1) {\r\n      const timer = setTimeout(() => {\r\n        this.bullets.push(new CirBullet({\r\n          p: {\r\n            x: originPos(this.axisRotateR, this.axisRotateAngle).x,\r\n            y: originPos(this.axisRotateR, this.axisRotateAngle).y,\r\n          },\r\n          rotateAngle: this.rotate,\r\n          moveX: -this.r - 10,\r\n          // rotateAngle: Math.sin(this.rotate * degToPi),\r\n          axisRotateR: this.axisRotateR,\r\n        }));\r\n        clearTimeout(timer);\r\n        // 間隔 0.2-0.4 秒\r\n      }, i * getRandom(200, 400));\r\n    }\r\n    gameCrawler.textContent = Math.random() >= 0.8 ? 'UNDER ATTACK🤕' : 'ATTACK⚡️';\r\n    playSound('membrane', 'D5');\r\n  }\r\n\r\n\r\n  appear(isBossGenerate) {\r\n    gameCrawler.textContent = '⚠ ENEMY IS COMING';\r\n    // gameCrawler.innerHTML = '<i class=\"fas fa-exclamation-triangle\"></i>ENEMY IS COMING!';\r\n    TweenLite.to(this, 0.8, {\r\n      scale: 1,\r\n      ease: Back.easeOut.config(1.7),\r\n    });\r\n    TweenLite.from(this, 1.6, {\r\n      rotate: 0,\r\n      ease: Back.easeOut.config(1.7),\r\n    });\r\n    if (isBossGenerate) {\r\n      TweenLite.to(this, 1.6, {\r\n        axisRotateR: `+=${getRandom(80, 160)}`,\r\n        ease: Power2.easeOut,\r\n      });\r\n    }\r\n    game.isStart && playSound('synth', 'F4', '4n');\r\n    // playSound('synth', 'B4', '8n', 50);\r\n  }\r\n}\r\n\r\n\r\n\r\nclass CirBullet {\r\n  constructor(args) {\r\n    const def = {\r\n      p: {\r\n        x: 0,\r\n        y: 0,\r\n      },\r\n      axisRotateR: 0,\r\n      color: globalColor.orange,\r\n      moveX: 0,\r\n      moveXV: -4.5,\r\n      // v: 4,\r\n      rotateAngle: 0,\r\n    }\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n  draw() {\r\n    ctx.save();\r\n      ctx.translate(this.p.x, this.p.y);\r\n      ctx.rotate(this.rotateAngle * degToPi); \r\n      ctx.beginPath();\r\n      ctx.arc(this.moveX, 0, 4, 0, Math.PI * 2);\r\n      ctx.fillStyle = this.color;\r\n      ctx.fill();\r\n    ctx.restore();\r\n  }\r\n  update(idx, arr) {\r\n    // 圓形子彈移動\r\n    this.moveX += this.moveXV;\r\n    // 子彈擊中 shooter\r\n    enemyMethods.attackShooter(this, idx, arr);\r\n  }\r\n}","/* \r\n ** 敵人方法\r\n */\r\nconst enemyMethods = {\r\n  // 逼近 shooter\r\n  approach(enemy) {\r\n    const axisRotateR = enemy.axisRotateR;\r\n    const isPolygon = typeof(axisRotateR) === 'object';\r\n    if (!enemy.axisRotateRV) {\r\n      const shooter = game.shooter;\r\n      const shooterBody = (shooter.r + (shooter.cirSolidLineW / 2));\r\n      const distance = (isPolygon ? axisRotateR.whole : (axisRotateR - enemy.r)) - shooterBody;\r\n      const seconds =  getRandom(30, 40);\r\n      enemy.axisRotateRV = -(distance / (seconds * updateFPS));\r\n    }\r\n    if (isPolygon) {\r\n      if (enemy.HP.whole) {\r\n        axisRotateR.small = axisRotateR.big = axisRotateR.whole += enemy.axisRotateRV;\r\n      } else {\r\n        // 重物引力較強\r\n        axisRotateR.big += enemy.axisRotateRV * getRandom(3, 4);\r\n        // 輕物引力較弱\r\n        axisRotateR.small += enemy.axisRotateRV * getRandom(1, 4);\r\n      }\r\n    } else {\r\n      enemy.axisRotateR += enemy.axisRotateRV;\r\n    }\r\n  },\r\n\r\n\r\n  // 死亡效果\r\n  dieEffect(enemyR, effectX, effectY, colorRGB, isBoss = false) {\r\n    let dieTime = 1;\r\n    let effect = () => {\r\n      if (!game.isPause) {\r\n        dieTime += 1;\r\n      }\r\n      ctx.beginPath();\r\n      ctx.save();\r\n      ctx.strokeStyle = `rgba(${colorRGB}, ${(48 - dieTime) / 46})`;\r\n      ctx.fillStyle = `rgba(${colorRGB}, ${(48 - dieTime) / 230})`;\r\n      ctx.shadowColor = `rgba(${colorRGB}, 0.48)`;\r\n      ctx.shadowBlur = 2;\r\n      ctx.lineWidth = 2;\r\n      const effectR = enemyR * baseLog(3, (((dieTime - 2) / 46) * 8) + 1);\r\n      ctx.arc(effectX, effectY, effectR, 0, Math.PI * 2);\r\n      ctx.fill();\r\n      ctx.stroke();\r\n      ctx.restore();\r\n      // }\r\n      if (dieTime < 48) {\r\n        requestAnimationFrame(effect);\r\n      }\r\n    }\r\n    requestAnimationFrame(effect);\r\n    if (!isBoss) {\r\n      setTimeout(() => {\r\n        gameCrawler.textContent = 'ENEMY DIES😇';\r\n      }, 0);\r\n    }\r\n    // playSound('duo', 'F4', '4n');\r\n    playSound('synth', 'G2', '8n', 0, 25);\r\n    playSound('duo', 'F2', '4n', 0, 15);\r\n    playSound('duo', 'E2', '4n', 0, 10);\r\n  },\r\n\r\n\r\n  // 敵人撞擊 shooter 判定\r\n  hitShooter(enemies, enemyIdx, type, enemyAxisRotateR, enemyAxisRotateAngle) {\r\n    const enemy = enemies[enemyIdx];\r\n    const shooter = game.shooter;\r\n    let shieldAngleRange;\r\n    if (shooter.state !== 'shield') {\r\n      shieldAngleRange = Math.abs(mouseMoveAngle - enemyAxisRotateAngle * degToPi) >= (135 * degToPi) && Math.abs(mouseMoveAngle - enemyAxisRotateAngle * degToPi) <= (225 * degToPi);\r\n    } else {\r\n      shieldAngleRange = Math.abs(mouseMoveAngle - enemyAxisRotateAngle * degToPi) >= (90 * degToPi) && Math.abs(mouseMoveAngle - enemyAxisRotateAngle * degToPi) <= (270 * degToPi);\r\n    }\r\n    // const shieldAngleRange = Math.abs(mouseMoveAngle - enemyAxisRotateAngle * degToPi) >= (135 * degToPi) && Math.abs(mouseMoveAngle - enemyAxisRotateAngle * degToPi) <= (225 * degToPi);\r\n    // 判斷是多邊形或其它敵人撞上 shooter\r\n    const judgeWhatEnemyHit = function () {\r\n      if (type !== 'big' && type !== 'small') {\r\n        enemies.splice(enemyIdx, 1);\r\n        // 移除敵人效果\r\n        if (type !== 'whole') {\r\n          const colorRGB = type === 'circle' ? '245, 175, 95' : '54, 118, 187';\r\n          enemyMethods.dieEffect(enemy.r, originPos(enemyAxisRotateR, enemyAxisRotateAngle).x, originPos(enemyAxisRotateR, enemyAxisRotateAngle).y, colorRGB);\r\n        } else {\r\n          const polygonR = (34 + 22) / 2;\r\n          enemyMethods.dieEffect(polygonR, enemy.originPos(type).x, enemy.originPos(type).y, '231, 70, 93');\r\n        }\r\n      } else {\r\n        enemy.HP[type] -= 1;\r\n        const polygonR = type === 'big' ? (34 + 22) / 2 : (23 + 21) / 2;\r\n        enemyMethods.dieEffect(polygonR, enemy.originPos(type).x, enemy.originPos(type).y, '231, 70, 93');\r\n        if (enemy.HP.big === 0 && enemy.HP.small === 0) {\r\n          enemies.splice(enemyIdx, 1);\r\n        }\r\n      }\r\n    }\r\n    // 當敵人撞上 shooter 主體\r\n    if (enemyAxisRotateR <= (shooter.r + (shooter.cirSolidLineW / 2))) {\r\n      // shooter.HP -= 1;\r\n      judgeWhatEnemyHit();\r\n      enemyMethods.attackShooterResult();\r\n      playSound('membrane', 'B4');\r\n      // 當敵人撞上 shooter 護盾\r\n    } else if (shieldAngleRange && (enemyAxisRotateR <= (shooter.shieldR + (shooter.shieldLineW / 2)))) {\r\n      judgeWhatEnemyHit();\r\n      shooter.isProtect = true;\r\n      gameCrawler.textContent = 'BLOCK😉';\r\n      playSound('membrane', 'D4');\r\n    }\r\n  },\r\n\r\n\r\n  // 敵人子彈擊中 shooter 判定\r\n  attackShooter(bullet, bulletIdx, bullets, bulletLen = 0) {\r\n    const shooter = game.shooter;\r\n    const shooterBody = shooter.r + (shooter.cirSolidLineW / 2);\r\n    const shooterShield = shooter.shieldR + (shooter.shieldLineW / 2);\r\n    // 當敵人子彈擊中 shooter 主體\r\n    if (Math.abs(bullet.moveX) >= (bullet.axisRotateR - (shooterBody + bulletLen))) {\r\n      // 子彈擊中後\r\n      enemyMethods.attackShooterResult();\r\n      // 移除敵人子彈\r\n      bullets.splice(bulletIdx, 1);\r\n      bullet.isBoss ? playSound('mono', 'C2', '8n', 0, -10) : playSound('membrane', 'B4');\r\n    }\r\n    // 當敵人子彈射中 shooter 的護盾\r\n    const bulletRotate = bullet.isBoss ? bullet.rotateAngle + 90 : bullet.rotateAngle;\r\n    const angleGap = Math.abs((mouseMoveAngle / degToPi) - ((bulletRotate % 360) + (bulletRotate < 0 ? 360 : 0)));\r\n    let shieldAngleRange;\r\n    if (shooter.state !== 'shield') {\r\n      shieldAngleRange = (angleGap >= 135) && (angleGap <= 225);\r\n    } else {\r\n      shieldAngleRange = (angleGap >= 90) && (angleGap <= 270);\r\n    }\r\n    if (shieldAngleRange && (Math.abs(bullet.moveX) >= (bullet.axisRotateR - (shooterShield + bulletLen)))) {\r\n      // 移除子彈\r\n      bullets.splice(bulletIdx, 1);\r\n      gameCrawler.textContent = 'BLOCK😉';\r\n      playSound('membrane', 'D4');\r\n    }\r\n  },\r\n\r\n\r\n  // 敵人撞擊或子彈擊中 shooter 後\r\n  attackShooterResult() {\r\n    if (!game.isStart || (game.currentLevel === 10 && !game.boss)) return;\r\n    const shooter = game.shooter;\r\n    const shooterHPBarOriginW = 216;\r\n    // 命條減 1/3\r\n    const shooterHPBarW = shooterHPBar.offsetWidth - (shooterHPBarOriginW / 3);\r\n    shooter.isAttacked = true;\r\n    // shooter 命減 1\r\n    // shooter.HP -= 1;\r\n    shooterHPBar.style.width = `${shooterHPBarW < 0 ? 0 : shooterHPBarW}px`;\r\n    // 若 shooter 已經沒有命條\r\n    if (shooterHPBarW <= 0) {\r\n      // 若 shooter 還有愛心\r\n      if (shooter.hearts) {\r\n        // 減掉一顆愛心\r\n        const shooterHeart = document.querySelectorAll('.panel__game-heart');\r\n        shooterHeart[0].parentNode.removeChild(shooterHeart[0]);\r\n        shooter.hearts -= 1;\r\n        // 回復命條\r\n        shooterHPBar.style.width = `${shooterHPBarOriginW}px`;\r\n      } else {\r\n        // 如果沒有愛心，結束遊戲\r\n        game.endGame();\r\n        playSound('synth', 'A3');\r\n        playSound('synth', 'E2', '8n', 160);\r\n        playSound('synth', 'A2', '8n', 320);\r\n        clearTimeout(game.crawlerClearedTimer);\r\n        gameCrawler.textContent = `YOU, ${this.playerName}💀, ARE DEAD`;\r\n        return;\r\n      }\r\n    }\r\n    gameCrawler.textContent = Math.random() >= 0.5 ? 'OUCH😣' : 'UGGH😫';\r\n  },\r\n\r\n\r\n  bossDieResult() {\r\n    let boss = game.boss;\r\n    enemyMethods.dieEffect(264, originPos(boss.axisRotateR, boss.axisRotateAngle).x, originPos(boss.axisRotateR, boss.axisRotateAngle).y, '245, 175, 95', true);\r\n    setTimeout(() => {\r\n      enemyMethods.dieEffect(264, originPos(boss.axisRotateR, boss.axisRotateAngle).x, originPos(boss.axisRotateR, boss.axisRotateAngle).y, '54, 118, 187', true);\r\n    }, 300);\r\n    setTimeout(() => {\r\n      enemyMethods.dieEffect(264, originPos(boss.axisRotateR, boss.axisRotateAngle).x, originPos(boss.axisRotateR, boss.axisRotateAngle).y, '231, 70, 93', true);\r\n    }, 600);\r\n    game.boss = null;\r\n    // 改變背景音樂\r\n    bgm.pause();\r\n    bgm.currentTime = 0;\r\n    victoryBgm.play();\r\n    victoryBgm.volume = 0.5;\r\n    // 3 秒後，結束遊戲\r\n    setTimeout(() => {\r\n      game.endGame();\r\n    }, 3000);\r\n    clearTimeout(game.crawlerClearedTimer);\r\n    gameCrawler.textContent = 'BOSS DIES!!!🎊';\r\n  }\r\n}","/* Environment Variable */\r\nconst updateFPS = 30;\r\nlet updateTime = 0;\r\n\r\nconst globalColor = {\r\n  red: '#e7465d',\r\n  orange: '#f5af5f',\r\n  yellow: '#f7b52c',\r\n  blue: '#3676bb',\r\n  blueDark: '#001d2e',\r\n  white: '#fff',\r\n}\r\n\r\nconst props = ['heart', 'crackdown', 'shield', 'double', 'wave'];\r\n\r\n\r\n/* GUI Controls */\r\n// const controls = {\r\n  // amp: 8,\r\n  // freq: 0.3,\r\n  // testAngle: 40,\r\n// }\r\n\r\n// const gui = new dat.GUI();\r\n// gui.add(controls, 'testAngle', 0, 90).step(1).onChange((value) => {});\r\n// gui.add(controls, 'freq', 0, 1).step(0.1).onChange((value) => {});\r\n\r\nconst startBtn = document.getElementById('start-btn');\r\nconst restartBtn = document.getElementById('restart-btn');\r\nconst starsBtn = document.getElementById('stars-btn');\r\nconst backBtn = document.getElementById('back-btn');\r\nconst restartBtnStars = document.getElementById('restart-btn--stars');\r\n\r\nconst cover = document.getElementById('cover');\r\nconst gamePanel = document.getElementById('game-panel');\r\nconst batteryInfo = document.getElementById('battery-info');\r\nconst shooterHPBar = document.getElementById('hp');\r\nconst heartWrapper = document.getElementById('heart-wrapper');\r\nconst prop = document.getElementById('prop');\r\nconst propImg = document.getElementById('prop__img');\r\nconst propLastTime = document.getElementById('prop__last-time');\r\nconst batteryNum = document.getElementById('battery-num');\r\nconst result = document.getElementById('game-result');\r\n// const resultNum = document.getElementById('result-num');\r\nconst panel = document.getElementById('panel');\r\nconst container = document.getElementById('container');\r\nconst keyboard = document.getElementById('keyboard');\r\nconst gameTime = document.getElementById('game-time');\r\nconst gameLevel = document.getElementById('game-level');\r\nconst gameCrawler = document.getElementById('game-crawler');\r\nconst playerName = document.getElementById('player-name');\r\n\r\nconst resultBoss = document.getElementById('result-boss');\r\nconst resultBattery = document.getElementById('result-battery');\r\nconst resultBullet = document.getElementById('result-bullet');\r\n// const totalPlayers = document.getElementById('total-players');\r\nconst rankingNum = document.getElementById('ranking-num');\r\n\r\nconst resultRanking = document.getElementById('result-ranking');\r\nconst resultScore = document.getElementById('result-score');\r\nconst resultStars = document.getElementById('result-stars');\r\n\r\n// const share = document.getElementById('share');\r\nconst bgm = document.getElementById('bgm');\r\nconst victoryBgm = document.getElementById('victory-bgm');\r\n\r\nconst starWrapper1 = document.getElementById('star-wrapper1');\r\nconst starWrapper2 = document.getElementById('star-wrapper2');\r\nconst starWrapper3 = document.getElementById('star-wrapper3');\r\n\r\nconst shareFb = document.getElementById('share-fb');\r\nconst shareTwitter = document.getElementById('share-twitter');\r\n\r\n\r\n\r\n\r\n/* Initialize Canvas Settings */\r\nconst canvas = document.getElementById('game');\r\nconst ctx = canvas.getContext('2d');\r\nlet ww;\r\nlet wh;\r\nlet gameW;\r\nlet gameH;\r\nlet gameHalfDiagonalL;\r\n\r\nfunction initCanvas() {\r\n  gameW = canvas.width;\r\n  gameH = canvas.height;\r\n  gameHalfDiagonalL = Math.round(Math.sqrt(canvas.width * canvas.width + canvas.height * canvas.height) / 2);\r\n  ww = document.documentElement.clientWidth;\r\n  wh = document.documentElement.clientHeight;\r\n}\r\n\r\n\r\n\r\nconst degToPi = Math.PI / 180;\r\nlet coverCircle;\r\nlet coverTriangle;\r\nlet coverPolygon;\r\nlet game;\r\n\r\n\r\n\r\nclass Game {\r\n  constructor(args) {\r\n    const def = {\r\n      shooter: null,\r\n      prop: null,\r\n      batteryNum: 0,\r\n      circles: [],\r\n      triangles: [],\r\n      polygons: [],\r\n      subTris: [],\r\n      isStart: false,\r\n      isEnd: false,\r\n      isPause: false,\r\n      blockV: {\r\n        x: -2,\r\n        y: 2,\r\n      },\r\n      currentLevel: 0,\r\n      countdownSeconds: 0,\r\n      // countupSeconds: 0,\r\n      hpRecoverTimer: null,\r\n      countdownTimer: null,\r\n      countupTimer: null,\r\n      propGeneratedTimer: null,\r\n      crawlerClearedTimer: null,\r\n      propGeneratedInterval: 200,\r\n      boss: null,\r\n      playerName: '',\r\n      beatBossSeconds: 0,\r\n      isMuted: false,\r\n      isDisplayStars: false,\r\n    };\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n  init() {\r\n    canvas.addEventListener('mousemove', handleMouseMove);\r\n    canvas.addEventListener('click', handleClick);\r\n    window.addEventListener('keyup', handleKeyup);\r\n    handlePlayerName();\r\n    startBtn.addEventListener('click', () => {\r\n      if (!this.checkPlayerName()) return;\r\n      this.startGame();\r\n    });\r\n    restartBtn.addEventListener('click', () => {\r\n      this.startGame();\r\n    });\r\n    restartBtnStars.addEventListener('click', () => {\r\n      this.startGame();\r\n    });\r\n    this.drawCover();\r\n    this.render();\r\n    this.update();\r\n    // 初始化方格移動速率與計時器\r\n    this.setBlockV();\r\n    // 緩慢恢復 shooter 生命條\r\n    this.recoverShooterHPBar();\r\n    starsBtn.addEventListener('click', () => {\r\n      resultRanking.classList.add('dpn');\r\n      resultScore.classList.add('dpn');\r\n      resultStars.classList.remove('dpn');\r\n      result.classList.add('t20');\r\n      if (!this.isDisplayStars) {\r\n        this.handleGameStars();\r\n      }\r\n      this.isDisplayStars = true;\r\n    });\r\n    backBtn.addEventListener('click', function () {\r\n      resultRanking.classList.remove('dpn');\r\n      resultScore.classList.remove('dpn');\r\n      resultStars.classList.add('dpn');\r\n      result.classList.remove('t20');\r\n    });\r\n    shareFb.addEventListener('click', function () {\r\n      window.open('https://www.facebook.com/sharer/sharer.php?u=https://yeefun.github.io/radio-defense', '', 'left=0,top=0,width=550,height=450,personalbar=0,toolbar=0,scrollbars=0,resizable=0');\r\n    });\r\n    shareTwitter.addEventListener('click', function () {\r\n      // 參考 https://gist.github.com/McKinneyDigital/2884508\r\n      const url = 'https://yeefun.github.io/radio-defense';\r\n      const name = 'szyeefun';\r\n      window.open(`http://twitter.com/share?url=${encodeURIComponent(url)}&via=${encodeURIComponent(name)}`, '', 'left=0,top=0,width=550,height=450,personalbar=0,toolbar=0,scrollbars=0,resizable=0');\r\n    });\r\n  }\r\n  render() {\r\n    // if (!this.isPause) {\r\n    ctx.fillStyle = globalColor.blueDark;\r\n    ctx.fillRect(0, 0, gameW, gameH);\r\n    // 繪製方格\r\n    this.drawBlock();\r\n    if (!this.isStart && !this.isEnd) {\r\n      ctx.save();\r\n        ctx.beginPath();\r\n        ctx.arc(gameW / 2, gameH / 2, 264, 0, Math.PI * 2);\r\n        ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';\r\n        ctx.stroke();\r\n        ctx.beginPath();\r\n        ctx.arc(gameW / 2, gameH / 2, 184, 0, Math.PI * 2);\r\n        ctx.lineWidth = 1.6;\r\n        ctx.strokeStyle = globalColor.white;\r\n        ctx.stroke();\r\n      ctx.restore();\r\n    }\r\n    // 繪製 shooter\r\n    this.shooter.draw();\r\n    // 繪製每個 circle\r\n    this.circles.forEach((circle) => {\r\n      circle.draw();\r\n    });\r\n    // 繪製每個 triangle\r\n    this.triangles.forEach((triangle) => {\r\n      triangle.draw();\r\n    });\r\n    // 繪製每個 polygon\r\n    this.polygons.forEach((polygon) => {\r\n      polygon.draw();\r\n    });\r\n    // 繪製每個 sub triangle\r\n    this.subTris.forEach((subTriangle) => {\r\n      subTriangle.draw();\r\n    });\r\n    // 繪製 prop（道具）\r\n    this.prop && this.prop.draw();\r\n    // 繪製魔王\r\n    this.boss && this.boss.draw();\r\n    if (this.isStart) {\r\n      // 繪製滑鼠\r\n      this.drawMouse();\r\n    }\r\n    requestAnimationFrame(() => {\r\n      this.render();\r\n    });\r\n  }\r\n  update() {\r\n    updateTime += 1;\r\n    if (!this.isPause && !this.isEnd) {\r\n      // 更新 shooter\r\n      this.shooter.update();\r\n      // 更新每個 circle\r\n      this.circles.forEach((circle, idx) => {\r\n        circle.update(idx);\r\n      });\r\n      // 更新每個 triangle\r\n      this.triangles.forEach((triangle, idx) => {\r\n        triangle.update(idx);\r\n      });\r\n      // 更新每個 polygon\r\n      this.polygons.forEach((polygon, idx) => {\r\n        polygon.update(idx);\r\n      });\r\n      // 更新每個 sub triangle\r\n      this.subTris.forEach((subTriangle, idx) => {\r\n        subTriangle.update(idx);\r\n      });\r\n      // 更新 prop（道具）\r\n      this.prop && this.prop.update();\r\n      // 更新魔王\r\n      this.boss && this.boss.update();\r\n    }\r\n    setTimeout(() => {\r\n      this.update();\r\n    }, 1000 / updateFPS);\r\n  }\r\n  // 設置封面\r\n  drawCover() {\r\n    this.shooter = new Shooter();\r\n    // 圓形\r\n    this.circles.push(new Circle({\r\n      axisRotateR: getRandom(gameHalfDiagonalL / 2, gameHalfDiagonalL / 1.5),\r\n      axisRotateAngle: 225,\r\n      axisRotateAngleV: -(getRandom(2, 8) / 10),\r\n      rotate: getRandom(0, 360),\r\n    }));\r\n    // 三角形\r\n    this.triangles.push(new Triangle({\r\n      axisRotateR: getRandom(gameHalfDiagonalL / 2, gameHalfDiagonalL / 1.5),\r\n      axisRotateAngle: 45,\r\n      axisRotateAngleV: (getRandom(2, 8) / 10),\r\n      rotate: 45,\r\n    }));\r\n    // 多邊形\r\n    const rotateR = getRandom(gameHalfDiagonalL / 2, gameHalfDiagonalL / 1.5);\r\n    const rotate = getRandom(0, 360);\r\n    const rotateV = (getRandom(4, 8) / 10);\r\n    this.polygons.push(new Polygon({\r\n      axisRotateR: {\r\n        whole: rotateR,\r\n        big: rotateR,\r\n        small: rotateR,\r\n      },\r\n      axisRotateAngle: {\r\n        whole: 315,\r\n        big: 315,\r\n        small: 315,\r\n      },\r\n      rotate: {\r\n        whole: rotate,\r\n        big: rotate,\r\n        small: rotate,\r\n      },\r\n      rotateV,\r\n    }));\r\n  }\r\n  // 畫方格\r\n  drawBlock() {\r\n    ctx.save();\r\n      ctx.beginPath();\r\n      ctx.strokeStyle = 'rgba(255, 255, 255, 0.16)';\r\n      ctx.lineWidth = 0.4;\r\n      // 畫橫列\r\n      for (let i = 0; i < 18; i += 1) {\r\n        ctx.moveTo(i * 56 + ((updateTime * this.blockV.x) % 56), 0);\r\n        ctx.lineTo(i * 56 + ((updateTime * this.blockV.x) % 56), gameH);\r\n      }\r\n      // 畫直行\r\n      for (let i = 0; i < 14; i += 1) {\r\n        ctx.moveTo(0, i * 52 + ((updateTime * this.blockV.y) % 52));\r\n        ctx.lineTo(gameW, i * 52 + ((updateTime * this.blockV.y) % 52));\r\n      }\r\n      ctx.stroke();\r\n    ctx.restore();\r\n  }\r\n  // 畫滑鼠\r\n  drawMouse() {\r\n    const mouseMovePosX = mouseMovePos.x + gameW / 2;\r\n    const mouseMovePosY = mouseMovePos.y + gameH / 2;\r\n    const length = 12;\r\n    ctx.save();\r\n      ctx.translate(mouseMovePosX, mouseMovePosY);\r\n      ctx.strokeStyle = globalColor.white;\r\n      ctx.lineWidth = 0.8;\r\n      ctx.beginPath();\r\n      ctx.moveTo(-length, 0);\r\n      ctx.lineTo(length, 0);\r\n      ctx.moveTo(0, -length);\r\n      ctx.lineTo(0, length);\r\n      ctx.stroke();\r\n    ctx.restore();\r\n    ctx.fillStyle = globalColor.white;\r\n    ctx.beginPath();\r\n    ctx.arc(mouseMovePosX, mouseMovePosY, 1.6, 0, Math.PI * 2);\r\n    ctx.fill();\r\n  }\r\n  // 設定方格移動速率\r\n  setBlockV() {\r\n    setTimeout(() => {\r\n      this.blockV.x = Math.random() * 8 - 4;\r\n      this.blockV.y = Math.random() * 8 - 4;\r\n      this.setBlockV();\r\n    }, 8000);\r\n  }\r\n  // 開始遊戲（當讀者按下 'Start Play' or 'Restart' 按鈕）\r\n  startGame() {\r\n    this.isStart = true;\r\n    this.isEnd = false;\r\n    // 移除封面\r\n    cover.style.display = 'none';\r\n    // 顯示遊戲介面\r\n    gamePanel.style.display = 'block';\r\n    // 電池資訊歸零\r\n    this.batteryNum = 0;\r\n    batteryNum.textContent = this.batteryNum;\r\n    // 重設生命條\r\n    shooterHPBar.style.width = '216px';\r\n    // 取得玩家名\r\n    this.playerName = playerName.value;\r\n    // 初始化 shooter\r\n    this.shooter = new Shooter();\r\n    // 三個愛心命\r\n    heartWrapper.innerHTML = '';\r\n    for (let i = 0; i < this.shooter.hearts; i++) {\r\n      const heart = document.createElement('DIV');\r\n      heart.classList.add('panel__game-heart');\r\n      heartWrapper.appendChild(heart);\r\n    }\r\n    // 清空敵人與子彈\r\n    this.circles.forEach((circle) => {\r\n      circle.bullets = [];\r\n    });\r\n    this.triangles.forEach((triangle) => {\r\n      triangle.bullets = [];\r\n      triangle.HP = 0;\r\n    });\r\n    this.circles = [];\r\n    this.triangles = [];\r\n    this.polygons = [];\r\n    if (this.boss) {\r\n      this.boss.bullets = [];\r\n      this.boss = null;\r\n    }\r\n    // 隱藏預設滑鼠\r\n    container.style.cursor = 'none';\r\n    // 隱藏結果\r\n    result.classList.add('op0');\r\n    // 讓滑鼠點擊無效\r\n    panel.style.pointerEvents = 'none';\r\n    // 顯示獲得電池資訊\r\n    batteryInfo.classList.remove('op0');\r\n    // 顯示鍵盤指示\r\n    keyboard.classList.remove('op0');\r\n    // 清空關卡字\r\n    gameLevel.textContent = '';\r\n    // 回到第 0 關\r\n    this.currentLevel = 0;\r\n    // 倒數計時 2 秒\r\n    this.countdownSeconds = 3;\r\n\r\n    gameCrawler.textContent = `👋${this.playerName}👋`;\r\n    gameTime.textContent = `00:0${this.countdownSeconds}”`;\r\n    const countdownStartTime = () => {\r\n      setTimeout(() => {\r\n        if (this.countdownSeconds === 0) {\r\n          this.currentLevel += 1;\r\n          this.setLevel(this.currentLevel);\r\n          // 開始產生道具\r\n          this.generateProp();\r\n          // 開始清除跑馬燈\r\n          this.clearCrawler();\r\n          return;\r\n        }\r\n        this.countdownSeconds -= 1;\r\n        gameTime.textContent = `00:0${this.countdownSeconds}”`;\r\n        switch (this.countdownSeconds) {\r\n          case 2:\r\n            gameCrawler.textContent = '🌊WAVES ARE COMING🌊';\r\n            break;\r\n          case 1:\r\n            gameCrawler.textContent = '😈ARE YOU READY?😈';\r\n            break;\r\n          case 0:\r\n            gameCrawler.textContent = '🔥🔥GO🔥🔥';\r\n            break;\r\n          default:\r\n            break;\r\n        }\r\n        playSound('synth', 'G4');\r\n        countdownStartTime();\r\n      }, 1000);\r\n    }\r\n    countdownStartTime();\r\n    playSound('synth', 'C#5');\r\n    playSound('synth', 'E5', '8n', 160);\r\n    // 改變背景音樂\r\n    victoryBgm.pause();\r\n    victoryBgm.currentTime = 0;\r\n    bgm.play();\r\n    bgm.volume = 0.5;\r\n    // 遊戲結果返回第一頁\r\n    resultRanking.classList.remove('dpn');\r\n    resultScore.classList.remove('dpn');\r\n    resultStars.classList.add('dpn');\r\n    result.classList.remove('t20');\r\n    // 將遊戲結果換成 loading 圖示\r\n    const loadingIcon = '<img src=\"./img/loading.svg\" alt=\"loading icon\" />';\r\n    rankingNum.innerHTML = loadingIcon;\r\n    starWrapper1.innerHTML = loadingIcon;\r\n    starWrapper2.innerHTML = loadingIcon;\r\n    starWrapper3.innerHTML = loadingIcon;\r\n    // 開啟讓 stars 重新取資料的開關\r\n    this.isDisplayStars = false;\r\n  }\r\n  // 遊戲結束\r\n  endGame() {\r\n    this.isStart = false;\r\n    this.isEnd = true;\r\n    // 貼上電池數量\r\n    // resultNum.textContent = this.batteryNum;\r\n    // 填上結果\r\n    if (this.currentLevel !== 10) {\r\n      resultBoss.textContent = 'NO';\r\n    } else {\r\n      resultBoss.textContent = this.beatBossSeconds;\r\n    }\r\n    resultBattery.textContent = this.batteryNum;\r\n    resultBullet.textContent = this.shooter.bulletNum;\r\n    // 顯示結果\r\n    result.classList.remove('op0');\r\n    // 隱藏電池分數資訊\r\n    batteryInfo.classList.add('op0');\r\n    // 隱藏鍵盤指示\r\n    keyboard.classList.add('op0');\r\n    // 移除道具顯示介面\r\n    prop.classList.add('op0');\r\n    // 顯示預設滑鼠\r\n    container.style.cursor = 'auto';\r\n    // 讓滑鼠可以點擊\r\n    panel.style.pointerEvents = 'auto';\r\n    this.handleGameResult();\r\n    clearTimeout(this.countdownTimer);\r\n    clearTimeout(this.countupTimer);\r\n    clearTimeout(this.propGeneratedTimer);\r\n  }\r\n  // 暫停遊戲\r\n  pauseGame() {\r\n    if (!this.currentLevel) return;\r\n    this.isPause = !this.isPause;\r\n    if (this.isPause) {\r\n      clearTimeout(this.countdownTimer);\r\n      clearTimeout(this.countupTimer);\r\n      clearTimeout(this.propGeneratedTimer);\r\n      clearTimeout(this.crawlerClearedTimer);\r\n    } else {\r\n      this.generateProp();\r\n      this.clearCrawler();\r\n      if (!this.boss) {\r\n        this.countdownTime();\r\n      } else {\r\n        this.countupTime();\r\n        if (this.boss.isDisappeared) {\r\n          clearTimeout(this.boss.appearTimer);\r\n          this.boss.appear();\r\n        } else {\r\n          clearTimeout(this.boss.disappearTimer);\r\n          this.boss.disappear();\r\n        }\r\n      }\r\n    }\r\n  }\r\n  handleGameResult() {\r\n    const name = this.playerName;\r\n    const level = this.currentLevel;\r\n    const battery = this.batteryNum;\r\n    const bullet = this.shooter.bulletNum;\r\n    let boss;\r\n    if (level !== 10) {\r\n      boss = 'no';\r\n    } else {\r\n      boss = this.beatBossSeconds;\r\n    }\r\n    axios.get('https://script.google.com/a/g.ntu.edu.tw/macros/s/AKfycbwwNUeevxFlQaLzP_gdhnTmSC97HgRlpV6DOCUIzg/dev', {\r\n      params: {\r\n        name,\r\n        level,\r\n        battery,\r\n        bullet,\r\n        boss,\r\n      }\r\n    })\r\n    .then((res) => {\r\n      const data = res.data;\r\n      rankingNum.innerHTML = `\r\n        <p>${data.rank}</p>\r\n        <span>/&nbsp;${data.totalPlayers}</span>\r\n      `;\r\n    });\r\n  }\r\n  handleGameStars() {\r\n    axios.get('https://script.google.com/a/g.ntu.edu.tw/macros/s/AKfycbx1L2GmotaRfoSMzVA5BtpC9kiWneoA69IOtoEi/dev')\r\n      .then((res) => {\r\n        const data = res.data;\r\n        const firstStarData = data.firstData;\r\n        const secondStarData = data.secondData;\r\n        const thirdStarData = data.thirdData;\r\n        let starScoreHTML = '';\r\n        function fillStarScore(name, wave, bat, bullet, boss) {\r\n          starScoreHTML = `\r\n            <div class=\"star__name\">${name}</div>\r\n            <div class=\"star__scores\">\r\n              <div class=\"star__score\">\r\n                <div class=\"star__num\">${wave}</div>\r\n                <div class=\"star__text\">WAVES</div>\r\n              </div>\r\n              <div class=\"star__score\">\r\n                <div class=\"star__num\">${bat}</div>\r\n                <div class=\"star__text\">BATTERIES</div>\r\n              </div>\r\n              <div class=\"star__score\">\r\n                <div class=\"star__num\">${bullet}</div>\r\n                <div class=\"star__text\">BULLETS</div>\r\n              </div>\r\n              <div class=\"star__score\">\r\n                <div class=\"star__num\">${boss}</div>\r\n                <div class=\"star__text\">BOSS</div>\r\n              </div>\r\n            </div>\r\n          `;\r\n        }\r\n        fillStarScore(...firstStarData);\r\n        starWrapper1.innerHTML = starScoreHTML;\r\n        fillStarScore(...secondStarData);\r\n        starWrapper2.innerHTML = starScoreHTML;\r\n        fillStarScore(...thirdStarData);\r\n        starWrapper3.innerHTML = starScoreHTML;\r\n      });\r\n  }\r\n  // 產生道具\r\n  generateProp() {\r\n    // 如果已有道具，便停止計時\r\n    if (this.prop) return;\r\n    this.propGeneratedTimer = setTimeout(() => {\r\n      this.propGeneratedInterval -= 1;\r\n      // 20 秒過後\r\n      if (this.propGeneratedInterval === 0) {\r\n        let propName;\r\n        // 如果大於 5 顆心，便排除愛心\r\n        if (this.shooter.hearts < 5) {\r\n          propName = props[getRandom(0, 4)];\r\n        } else {\r\n          propName = props[getRandom(1, 4)];\r\n        }\r\n        this.prop = new Prop({\r\n          src: `../img/${propName}.svg`,\r\n          axisRotateR: gameHalfDiagonalL,\r\n          axisRotateAngle: getRandom(0, 360),\r\n        });\r\n        // 每 20 (200 * 100) 秒產生一個道具\r\n        this.propGeneratedInterval = 200;\r\n      }\r\n      this.generateProp();\r\n    }, 100);\r\n  }\r\n  // 倒數遊戲時間\r\n  countdownTime() {\r\n    this.countdownTimer = setTimeout(() => {\r\n      if (this.countdownSeconds === 0) {\r\n        this.currentLevel += 1;\r\n        this.setLevel(this.currentLevel);\r\n        return;\r\n      }\r\n      this.countdownSeconds -= 1;\r\n      gameTime.textContent = `00:${this.countdownSeconds < 10 ? `0${this.countdownSeconds}` : this.countdownSeconds}”`;\r\n      this.countdownTime();\r\n    }, 1000);\r\n  }\r\n  countupTime() {\r\n    this.countupTimer = setTimeout(() => {\r\n      this.beatBossSeconds += 1;\r\n      const minutes = Math.floor(this.beatBossSeconds / 60);\r\n      const trueSeconds = this.beatBossSeconds % 60;\r\n      const TimeSeconds = trueSeconds < 10 ? `0${trueSeconds}` : trueSeconds;\r\n      const TimeMinutes = minutes < 10 ? `0${minutes}` : minutes;\r\n      gameTime.textContent = `${TimeMinutes}:${TimeSeconds}”`;\r\n      this.countupTime();\r\n    }, 1000);\r\n  }\r\n  // 自動恢復 shooter 生命條\r\n  recoverShooterHPBar() {\r\n    this.hpRecoverTimer = setTimeout(() => {\r\n      if (this.isPause || !this.isStart) {\r\n        this.recoverShooterHPBar();\r\n        return;\r\n      }\r\n      const nowHPW = shooterHPBar.offsetWidth;\r\n      if (nowHPW < 216) {\r\n        const recoverHPBarW = nowHPW + 1;\r\n        shooterHPBar.style.width = `${recoverHPBarW}px`;\r\n      }\r\n      this.recoverShooterHPBar();\r\n    }, 300);\r\n  }\r\n  // 每 3 秒清除一次跑馬燈\r\n  clearCrawler() {\r\n    gameCrawler.textContent = '';\r\n    // CONFUSED 為什麼這樣寫不行？（只會觸發兩次）\r\n    // setTimeout(this.clearCrawler, 3000);\r\n    this.crawlerClearedTimer = setTimeout(() => {\r\n      this.clearCrawler();\r\n    }, 3000);\r\n  }\r\n  // 設定敵人出場\r\n  setEnemy(form, seconds = 0) {\r\n    setTimeout(() => {\r\n      switch (form) {\r\n        case 'circle': {\r\n          this.circles.push(new Circle({\r\n            axisRotateR: getRandom(gameHalfDiagonalL / 3, gameHalfDiagonalL),\r\n            axisRotateAngle: getRandom(0, 360),\r\n            axisRotateAngleV: -(getRandom(2, 8) / 10),\r\n            rotate: getRandom(0, 360),\r\n          }));\r\n          break;\r\n        }\r\n        case 'triangle': {\r\n          // axisRotateAngle 與 rotate 必須相同\r\n          const angle = getRandom(0, 360);\r\n          this.triangles.push(new Triangle({\r\n            axisRotateR: getRandom(gameHalfDiagonalL / 3, gameHalfDiagonalL),\r\n            axisRotateAngle: angle,\r\n            axisRotateAngleV: getRandom(2, 8) / 10,\r\n            rotate: angle,\r\n          }));\r\n          break;\r\n        }\r\n        case 'polygon': {\r\n          const rotateR = getRandom(gameHalfDiagonalL / 3, gameHalfDiagonalL / 1.5);\r\n          const rotateAngle = getRandom(0, 360);\r\n          const rotate = getRandom(0, 360);\r\n          this.polygons.push(new Polygon({\r\n            axisRotateR: {\r\n              whole: rotateR,\r\n              big: rotateR,\r\n              small: rotateR,\r\n            },\r\n            axisRotateAngle: {\r\n              whole: rotateAngle,\r\n              big: rotateAngle,\r\n              small: rotateAngle,\r\n            },\r\n            rotate: {\r\n              whole: rotate,\r\n              big: rotate,\r\n              small: rotate,\r\n            },\r\n            rotateV: getRandom(4, 8) / 10,\r\n          }));\r\n          break;\r\n        }\r\n        default:\r\n          break;\r\n      }\r\n    }, seconds * 1000);\r\n  }\r\n  // 初始化關卡\r\n  initLevel(level, seconds) {\r\n    gameLevel.textContent = `Wave ${level}`;\r\n    this.countdownSeconds = seconds;\r\n    gameTime.textContent = `00:${this.countdownSeconds}”`;\r\n    this.countdownTime();\r\n  }\r\n  // 設定關卡\r\n  setLevel(level) {\r\n    switch (level) {\r\n      case 1:\r\n        this.initLevel('01', 15);\r\n        // const rotateNum = 360;\r\n        // this.boss = new Boss({\r\n        //   axisRotateR: getRandom(gameH / 3, gameH / 2.5),\r\n        //   axisRotateAngle: rotateNum,\r\n        //   rotate: rotateNum - 90,\r\n        // });\r\n        // 設定敵人出場\r\n        this.setEnemy('circle', 2);\r\n        break;\r\n      case 2:\r\n        this.initLevel('02', 20);\r\n        this.setEnemy('triangle', 2);\r\n        this.setEnemy('polygon', 10);\r\n        break;\r\n      case 3:\r\n        this.initLevel('03', 20);\r\n        this.setEnemy('polygon', 2);\r\n        this.setEnemy('circle', 5);\r\n        this.setEnemy('polygon', 10);\r\n        break;\r\n      case 4:\r\n        this.initLevel('04', 30);\r\n        this.setEnemy('circle', 2);\r\n        this.setEnemy('triangle', 2);\r\n        this.setEnemy('polygon', 10);\r\n        this.setEnemy('triangle', 15);\r\n        this.setEnemy('polygon', 20);\r\n        break;\r\n      case 5:\r\n        this.initLevel('05', 30);\r\n        this.setEnemy('circle', 2);\r\n        this.setEnemy('circle', 5);\r\n        this.setEnemy('polygon', 15);\r\n        this.setEnemy('triangle', 20);\r\n        break;\r\n      case 6:\r\n        this.initLevel('06', 40);\r\n        this.setEnemy('triangle', 2);\r\n        this.setEnemy('triangle', 5);\r\n        this.setEnemy('circle', 15);\r\n        this.setEnemy('circle', 30);\r\n        this.setEnemy('polygon', 30);\r\n        break;\r\n      case 7:\r\n        this.initLevel('07', 60);\r\n        this.setEnemy('circle', 2);\r\n        this.setEnemy('triangle', 2);\r\n        this.setEnemy('circle', 10);\r\n        this.setEnemy('triangle', 10);\r\n        this.setEnemy('polygon', 15);\r\n        this.setEnemy('polygon', 20);\r\n        this.setEnemy('triangle', 25);\r\n        this.setEnemy('triangle', 35);\r\n        this.setEnemy('polygon', 40);\r\n        this.setEnemy('circle', 45);\r\n        break;\r\n      case 8:\r\n        this.initLevel('08', 60);\r\n        this.setEnemy('circle', 5);\r\n        this.setEnemy('triangle', 10);\r\n        this.setEnemy('polygon', 15);\r\n        this.setEnemy('circle', 20);\r\n        this.setEnemy('polygon', 30);\r\n        this.setEnemy('triangle', 35);\r\n        this.setEnemy('polygon', 35);\r\n        this.setEnemy('triangle', 45);\r\n        this.setEnemy('circle', 50);\r\n        this.setEnemy('polygon', 50);\r\n        break;\r\n      case 9:\r\n        this.initLevel('09', 40);\r\n        this.setEnemy('circle', 2);\r\n        this.setEnemy('triangle', 2);\r\n        this.setEnemy('triangle', 5);\r\n        this.setEnemy('polygon', 10);\r\n        this.setEnemy('circle', 15);\r\n        this.setEnemy('polygon', 15);\r\n        this.setEnemy('circle', 25);\r\n        this.setEnemy('triangle', 30);\r\n        break;\r\n      case 10:\r\n        gameLevel.textContent = 'Wave 10';\r\n        const rotateNum = getRandom(0, 360);\r\n        this.boss = new Boss({\r\n          axisRotateR: getRandom(gameH / 3, gameH / 2.5),\r\n          axisRotateAngle: rotateNum,\r\n          rotate: rotateNum - 90,\r\n        });\r\n        this.countupTime();\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    playSound('synth', 'A6');\r\n  }\r\n  checkPlayerName() {\r\n    // const playerName = document.getElementById('player-name').value;\r\n    if (playerName.value) {\r\n      return true;\r\n    } else {\r\n      playerName.classList.add('warn');\r\n      playSound('synth', 'A3');\r\n      playSound('synth', 'A2', '8n', 160);\r\n      return false;\r\n    }\r\n  }\r\n}\r\n\r\n\r\n\r\n// Page Loaded\r\nfunction handleLoad() {\r\n  game = new Game();\r\n  initCanvas();\r\n  game.init();\r\n}\r\n\r\n// load & resize event\r\nwindow.addEventListener('load', handleLoad);\r\nwindow.addEventListener('resize', initCanvas);\r\n\r\n\r\n\r\n// Mouse Events & Recording\r\nlet mouseMovePos = {}\r\nlet mouseMoveAngle = 0;\r\nfunction handleMouseMove(evt) {\r\n  mouseMovePos.x = evt.x - ww / 2;\r\n  mouseMovePos.y = evt.y - wh / 2;\r\n  const angle = Math.atan2(mouseMovePos.y, mouseMovePos.x);\r\n  mouseMoveAngle = angle < 0 ? (angle + 2 * Math.PI) : angle;\r\n};\r\n\r\nlet beforeShootTime = new Date();\r\nfunction handleClick() {\r\n  if (game.isPause) return;\r\n  game.shooter.shoot();\r\n};\r\n\r\nfunction handleKeyup(evt) {\r\n  if (game.isStart) {\r\n    if (evt.key === 's') {\r\n      game.shooter.shoot();\r\n    }\r\n    if (evt.key === 'p') {\r\n      game.pauseGame();\r\n    }\r\n  } else {\r\n    if (evt.key === 'Enter') {\r\n      if (!game.checkPlayerName()) return;\r\n      game.startGame();\r\n    }\r\n  }\r\n  if (evt.key === 'm') {\r\n    game.isMuted = !game.isMuted;\r\n    bgm.muted = !bgm.muted;\r\n    victoryBgm.muted = !victoryBgm.muted;\r\n  }\r\n}\r\n\r\nfunction handlePlayerName() {\r\n  playerName.addEventListener('focus', function () {\r\n    playerName.classList.remove('shine');\r\n    playerName.classList.remove('warn');\r\n  });\r\n\r\n  playerName.addEventListener('focusout', function () {\r\n    if (!playerName.value) {\r\n      playerName.classList.add('shine');\r\n    }\r\n  });\r\n\r\n  playerName.addEventListener('input', function () {\r\n    if (playerName.value) {\r\n      startBtn.classList.add('shine');\r\n    } else {\r\n      startBtn.classList.remove('shine');\r\n    }\r\n  });\r\n}","class Polygon {\r\n  constructor(args) {\r\n    const def = {\r\n      axisRotateR: {\r\n        whole: 0,\r\n        big: 0,\r\n        small: 0,\r\n      },\r\n      axisRotateAngle: {\r\n        whole: 0,\r\n        big: 0,\r\n        small: 0,\r\n      },\r\n      rotate: {\r\n        whole: 0,\r\n        big: 0,\r\n        small: 0,\r\n      },\r\n      HP: {\r\n        whole: 1,\r\n        big: 1,\r\n        small: 1,\r\n      },\r\n      axisRotateRV: 0,\r\n      rotateV: 0,\r\n      color: globalColor.red,\r\n      // 是否正好要分裂\r\n      isJustSplite: true,\r\n      scale: 0,\r\n      beginAppear: true,\r\n      isBossGenerate: false,\r\n    }\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n\r\n\r\n  originPos(form) {\r\n    return {\r\n      x: (gameW / 2) + this.axisRotateR[form] * Math.cos(this.axisRotateAngle[form] * degToPi),\r\n      y: (gameH / 2) + this.axisRotateR[form] * Math.sin(this.axisRotateAngle[form] * degToPi),\r\n    };\r\n  }\r\n\r\n\r\n  draw() {\r\n    if (this.HP.whole) {\r\n      ctx.save();\r\n      ctx.translate(this.originPos('whole').x, this.originPos('whole').y);\r\n      ctx.rotate(this.rotate.whole * degToPi);\r\n      ctx.scale(this.scale, this.scale);\r\n      // 主體多邊形\r\n      ctx.beginPath();\r\n      ctx.fillStyle = this.color;\r\n      ctx.moveTo(21 * Math.cos(8 * degToPi), 21 * Math.sin(8 * degToPi));\r\n      ctx.$triLineTo(23, 70);\r\n      ctx.$triLineTo(23, 150);\r\n      ctx.$triLineTo(34, 202);\r\n      ctx.$triLineTo(22, 255);\r\n      ctx.$triLineTo(22, 324);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n      // 右淡五邊形\r\n      ctx.beginPath();\r\n      ctx.fillStyle = 'rgba(255, 255, 255, 0.07)';\r\n      ctx.moveTo(9.6, -2);\r\n      ctx.$triLineTo(22, 324);\r\n      ctx.$triLineTo(21, 8);\r\n      ctx.$triLineTo(23, 70);\r\n      ctx.$triLineTo(10, 36);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n      // 下淡四邊形\r\n      ctx.beginPath();\r\n      ctx.fillStyle = 'rgba(255, 255, 255, 0.21)';\r\n      ctx.moveTo(10 * Math.cos(40 * degToPi), 10 * Math.sin(40 * degToPi));\r\n      ctx.$triLineTo(23, 70);\r\n      ctx.$triLineTo(23, 150);\r\n      ctx.lineTo(-8.8, 0);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n      // 閃電\r\n      drawLightning({\r\n        x: -0.8,\r\n        y: -16\r\n      });\r\n      ctx.restore();\r\n    } else {\r\n      // 大分裂四邊形\r\n      if (this.HP.big) {\r\n        ctx.save();\r\n        ctx.translate(this.originPos('big').x, this.originPos('big').y);\r\n        ctx.rotate(this.rotate.big * degToPi);\r\n        // 大分裂主體\r\n        ctx.beginPath();\r\n        ctx.fillStyle = this.color;\r\n        ctx.moveTo(23 * Math.cos(70 * degToPi), 23 * Math.sin(70 * degToPi));\r\n        ctx.$triLineTo(23, 150);\r\n        ctx.$triLineTo(34, 202);\r\n        ctx.$triLineTo(22, 255);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n        // 大分裂內下四邊形\r\n        ctx.fillStyle = 'rgba(255, 255, 255, 0.21)';\r\n        ctx.beginPath();\r\n        ctx.moveTo(-8.8, 0);\r\n        ctx.$triLineTo(4.8, 64);\r\n        ctx.$triLineTo(23, 70);\r\n        ctx.$triLineTo(23, 150);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n        // 大分裂左閃電\r\n        drawLightning({\r\n          x: -12,\r\n          y: -8\r\n        }, 0.6);\r\n        ctx.restore();\r\n      }\r\n      // 小分裂四邊形\r\n      if (this.HP.small) {\r\n        ctx.save();\r\n        ctx.translate(this.originPos('small').x, this.originPos('small').y);\r\n        ctx.rotate(this.rotate.small * degToPi);\r\n        // 小分裂主體\r\n        ctx.beginPath();\r\n        ctx.fillStyle = this.color;\r\n        ctx.moveTo(23 * Math.cos(70 * degToPi), 23 * Math.sin(70 * degToPi));\r\n        ctx.$triLineTo(22, 255);\r\n        ctx.$triLineTo(22, 324);\r\n        ctx.$triLineTo(21, 8);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n        // 小分裂內下三角形\r\n        ctx.beginPath();\r\n        ctx.fillStyle = 'rgba(255, 255, 255, 0.21)';\r\n        ctx.moveTo(10 * Math.cos(40 * degToPi), 10 * Math.sin(40 * degToPi));\r\n        ctx.$triLineTo(4.8, 64);\r\n        ctx.$triLineTo(23, 70);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n        // 小分裂內右五邊形\r\n        ctx.beginPath();\r\n        ctx.fillStyle = 'rgba(255, 255, 255, 0.07)';\r\n        ctx.moveTo(9.6, -2);\r\n        ctx.$triLineTo(22, 324);\r\n        ctx.$triLineTo(21, 8);\r\n        ctx.$triLineTo(23, 70);\r\n        ctx.$triLineTo(10, 36);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n        // 小分裂閃電\r\n        drawLightning({\r\n          x: 10,\r\n          y: -8\r\n        }, 0.5);\r\n        ctx.restore();\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  update(idx) {\r\n    this.beginAppear && this.appear(this.isBossGenerate);\r\n    this.beginAppear = false;\r\n    enemyMethods.approach(this);\r\n    // 如果尚未分裂\r\n    if (this.HP.whole) {\r\n      this.rotate.whole = this.rotate.big = this.rotate.small += this.rotateV;\r\n      // 當多邊形撞上 shooter\r\n      game.isStart && enemyMethods.hitShooter(game.polygons, idx, 'whole', this.axisRotateR.whole, this.axisRotateAngle.whole);\r\n    } else {\r\n      // let rotateDirection;\r\n      // 如果正好要分裂\r\n      if (this.isJustSplite) {\r\n        // const rotateOriginPos = 90 - 70;\r\n        // const rotateDirection = (((this.rotate.whole % 360) >= rotateOriginPos) && ((this.rotate.whole % 360) < (180 + rotateOriginPos))) ? -1 : 1;\r\n        const rotateDirection = Math.random() >= 0.5 ? 1 : -1;\r\n        TweenLite.to(this.axisRotateAngle, 2.4, {\r\n          big: `+=${getRandom(15, 30) * rotateDirection}`,\r\n          small: `-=${getRandom(15, 30) * rotateDirection}`,\r\n          ease: Circ.easeOut,\r\n        });\r\n        TweenLite.to(this.axisRotateR, 2.4, {\r\n          big: `+=${getRandom(50, 150)}`,\r\n          small: `+=${getRandom(50, 150)}`,\r\n          ease: Circ.easeOut,\r\n        });\r\n        TweenLite.to(this.rotate, 2.4, {\r\n          big: `+=${getRandom(180, 270)}`,\r\n          small: `-=${getRandom(180, 270)}`,\r\n          ease: Circ.easeOut,\r\n        });\r\n        // gameCrawler.textContent = 'ENEMY SPLITS';\r\n        this.isJustSplite = false;\r\n      }\r\n      // 當大分裂撞上 shooter\r\n      if (this.HP.big) {\r\n        // 重物自轉較慢\r\n        this.rotate.big += this.rotateV * 1.4;\r\n        enemyMethods.hitShooter(game.polygons, idx, 'big', this.axisRotateR.big, this.axisRotateAngle.big);\r\n      }\r\n      // 當小分裂撞上 shooter\r\n      if (this.HP.small) {\r\n        // 輕物自轉較快\r\n        this.rotate.small -= this.rotateV * 1.6;\r\n        enemyMethods.hitShooter(game.polygons, idx, 'small', this.axisRotateR.small, this.axisRotateAngle.small);\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  appear(isBossGenerate) {\r\n    gameCrawler.textContent = '⚠ ENEMY IS COMING';\r\n    TweenLite.to(this, 0.8, {\r\n      scale: 1,\r\n      ease: Back.easeOut.config(1.7),\r\n    });\r\n    if (isBossGenerate) {\r\n      const rotateNum = getRandom(40, 80);\r\n      const rNum = getRandom(40, 80);\r\n      TweenLite.to(this.axisRotateAngle, 1.6, {\r\n        whole: `-=${rotateNum}`,\r\n        big: `-=${rotateNum}`,\r\n        small: `-=${rotateNum}`,\r\n        ease: Power2.easeOut,\r\n      });\r\n      TweenLite.to(this.axisRotateR, 1.6, {\r\n        whole: `+=${rNum}`,\r\n        big: `+=${rNum}`,\r\n        small: `+=${rNum}`,\r\n        ease: Power2.easeOut,\r\n      });\r\n    }\r\n    game.isStart && playSound('synth', 'C4', '4n');\r\n  }\r\n}","/* 道具 class */\r\nclass Prop {\r\n  constructor(args) {\r\n    const def = {\r\n      img: new Image(),\r\n      src: '',\r\n      axisRotateR: 0,\r\n      axisRotateRV: 0,\r\n      axisRotateAngle: 0,\r\n      r: 32,\r\n    }\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n  draw() {\r\n    if (!this.img.src) {\r\n      // 防止 Failed to execute 'drawImage' on 'CanvasRenderingContext2D': The HTMLImageElement provided is in the 'broken' state.\r\n      this.img.width = 44;\r\n      this.img.height = 44;\r\n      this.img.src = this.src;\r\n    }\r\n    if (this.img.complete) {\r\n      ctx.save();\r\n      ctx.translate(originPos(this.axisRotateR, this.axisRotateAngle).x, originPos(this.axisRotateR, this.axisRotateAngle).y);\r\n      ctx.drawImage(this.img, 0, 0);\r\n      ctx.beginPath();\r\n      ctx.strokeStyle = 'rgba(255, 255, 255, 0.8)';\r\n      ctx.arc(this.img.width / 2, this.img.height / 2, this.r, 0, Math.PI * 2);\r\n      ctx.stroke();\r\n      ctx.restore();\r\n    }\r\n  }\r\n  update() {\r\n    if (!this.axisRotateRV) {\r\n      const seconds = getRandom(5, 8);\r\n      this.axisRotateRV = -(gameHalfDiagonalL / (seconds * updateFPS));\r\n    }\r\n    this.axisRotateR += this.axisRotateRV;\r\n    // 當道具撞上 shooter 主體\r\n    const shooter = game.shooter;\r\n    // 判斷是否撞上\r\n    if ((this.axisRotateR + this.r) <= (shooter.r + (shooter.cirSolidLineW / 2))) {\r\n      // 清掉該道具\r\n      game.prop = '';\r\n      const propName = this.src.replace('../img/', '').split('.')[0];\r\n      shooter.getProp(propName);\r\n    }\r\n  }\r\n}","class Shooter {\r\n  constructor(args) {\r\n    const def = {\r\n      color: globalColor.white,\r\n      // r: 34 * 0.85,\r\n      r: 28.9,\r\n      // shieldR: (34 + 36) * 0.85,\r\n      shieldR: 60,\r\n      // cirSolidLineW: 6 * 0.85,\r\n      cirSolidLineW: 6,\r\n      // shieldLineW: 4 * 0.85,\r\n      shieldLineW: 4,\r\n      rotateAngle: 0,\r\n      bullets: [],\r\n      bulletNum: 0,\r\n      hearts: 3,\r\n      state: '',\r\n      isAttacked: false,\r\n      isProtect: false,\r\n      beforeShootTime: new Date(),\r\n    };\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n  draw() {\r\n    if (!game.isStart && !game.isEnd) return;\r\n    ctx.save();\r\n    // 輪圍\r\n    ctx.translate(gameW / 2, gameH / 2);\r\n    ctx.save();\r\n    ctx.beginPath();\r\n    ctx.shadowColor = 'rgba(255, 255, 255, 0.4)';\r\n    ctx.shadowBlur = 16;\r\n    ctx.lineWidth = this.cirSolidLineW;\r\n    ctx.arc(0, 0, this.r, 0, Math.PI * 2);\r\n    if (!this.isAttacked) {\r\n      ctx.strokeStyle = this.color;\r\n    } else {\r\n      ctx.strokeStyle = globalColor.red;\r\n      this.isAttacked = false;\r\n    }\r\n    ctx.stroke();\r\n    // 輪軸\r\n    ctx.beginPath();\r\n    ctx.moveTo(0, 0);\r\n    ctx.$triLineTo(this.r, 0, this.rotateAngle);\r\n    ctx.moveTo(0, 0);\r\n    ctx.$triLineTo(this.r, 120, this.rotateAngle);\r\n    ctx.moveTo(0, 0);\r\n    ctx.$triLineTo(this.r, 240, this.rotateAngle);\r\n    // ctx.lineWidth = 3 * 0.85;\r\n    ctx.lineWidth = 2.55;\r\n    ctx.stroke();\r\n    ctx.restore();\r\n    // 輪圍外虛線\r\n    ctx.strokeStyle = this.color;\r\n    // const outerR = this.r + 22 * 0.85;\r\n    const outerR = this.r + 20;\r\n    for (let i = 0; i < 360; i += 1) {\r\n      const x1 = outerR * Math.cos(i * degToPi + this.rotateAngle);\r\n      const y1 = outerR * Math.sin(i * degToPi + this.rotateAngle);\r\n      const x2 = outerR * Math.cos((i + 1) * degToPi + this.rotateAngle);\r\n      const y2 = outerR * Math.sin((i + 1) * degToPi + this.rotateAngle);\r\n      if (i % 10 < 5) {\r\n        ctx.beginPath();\r\n        ctx.moveTo(x1, y1);\r\n        ctx.lineTo(x2, y2);\r\n        ctx.lineWidth = 1;\r\n        ctx.stroke();\r\n      }\r\n    }\r\n    // 護盾\r\n    ctx.beginPath();\r\n    ctx.lineWidth = this.shieldLineW;\r\n    // 如果 shooter 狀態為 shield，護盾變為 180°\r\n    if (this.state !== 'shield') {\r\n      ctx.arc(0, 0, this.shieldR, 135 * degToPi + this.rotateAngle, 225 * degToPi + this.rotateAngle);\r\n    } else {\r\n      ctx.arc(0, 0, this.shieldR, 90 * degToPi + this.rotateAngle, 270 * degToPi + this.rotateAngle);\r\n    }\r\n    if (!this.isProtect) {\r\n      ctx.strokeStyle = this.color;\r\n    } else {\r\n      ctx.strokeStyle = globalColor.blue;\r\n      this.isProtect = false;\r\n    }\r\n    ctx.stroke();\r\n    // 砲口\r\n    ctx.beginPath();\r\n    ctx.save();\r\n    ctx.shadowColor = 'rgba(255, 255, 255, 0.4)';\r\n    ctx.shadowBlur = 16;\r\n    ctx.rotate(this.rotateAngle);\r\n    ctx.translate(this.r + 8, 0);\r\n    ctx.moveTo(0, 0);\r\n    // 下方長方形長 13.6、寬（高） 10.2\r\n    // 上方梯形高 11.8、上邊寬 6.8\r\n    ctx.lineTo(0, 6.8);\r\n    ctx.lineTo(10.2, 6.8);\r\n    ctx.lineTo(22.1, 3.4);\r\n    ctx.lineTo(22.1, -3.4);\r\n    ctx.lineTo(10.2, -6.8);\r\n    ctx.lineTo(0, -6.8);\r\n    ctx.closePath();\r\n    ctx.fillStyle = this.color;\r\n    ctx.fill();\r\n    ctx.restore();\r\n    ctx.restore();\r\n    // 發射子彈\r\n    this.bullets.forEach((bullet) => {\r\n      bullet.draw();\r\n    });\r\n  }\r\n  update() {\r\n    this.rotateAngle = mouseMoveAngle;\r\n    this.bullets.forEach((bullet, idx) => {\r\n      bullet.update(idx);\r\n    });\r\n  }\r\n  shoot() {\r\n    const shootTime = new Date();\r\n    if (shootTime - beforeShootTime > 400) {\r\n      let bulletNum;\r\n      // 如果 shooter 狀態為 double，每次射兩發，兩發之間隔 0.16 秒\r\n      if (this.state !== 'double') {\r\n        bulletNum = 1;\r\n      } else {\r\n        bulletNum = 2;\r\n      }\r\n      for (let i = 0; i < bulletNum; i++) {\r\n        if (this.state !== 'wave') {\r\n          setTimeout(() => {\r\n            this.bulletNum += 1;\r\n            this.bullets.push(new ShooterBullet({\r\n              // axisRotateR: 62 * 0.85,\r\n              axisRotateR: 52.7,\r\n              rotateAngle: mouseMoveAngle,\r\n            }));\r\n            playSound('membrane', 'D3');\r\n          }, 160 * i);\r\n        } else {\r\n          setTimeout(() => {\r\n            this.bulletNum += 1;\r\n            this.bullets.push(new ShooterBullet({\r\n              waveLength: getRandom(40, 80),\r\n              waveFreq: getRandom(2, 4) / 10,\r\n              waveAmp: getRandom(4, 8),\r\n              waveFlow: getRandom(4, 8),\r\n              // axisRotateR: 70 * 0.85,\r\n              axisRotateR: 59.5,\r\n              rotateAngle: mouseMoveAngle,\r\n            }));\r\n            playSound('mono', 'F2', '4n', 0, -10);\r\n          }, 160 * i);\r\n        }\r\n      }\r\n      beforeShootTime = shootTime;\r\n    }\r\n  }\r\n  getProp(propName) {\r\n    // 持續秒數\r\n    let lastTime;\r\n    switch (propName) {\r\n      case 'heart':\r\n        this.recoverHeart();\r\n        lastTime = 0;\r\n        gameCrawler.textContent = 'GAIN LIFE💕';\r\n        break;\r\n      case 'crackdown':\r\n        this.drawCrackdownEffect();\r\n        lastTime = 0;\r\n        gameCrawler.textContent = 'BOOM💥';\r\n        break;\r\n      case 'shield':\r\n        lastTime = 25000;\r\n        gameCrawler.textContent = 'EXTEND SHIELD💪';\r\n        break;\r\n      case 'double':\r\n        lastTime = 20000;\r\n        gameCrawler.textContent = 'DOUBLE SHOOT✌️';\r\n        break;\r\n      case 'wave':\r\n        lastTime = 15000;\r\n        gameCrawler.textContent = 'WAVE BULLET🌊';\r\n        break;\r\n      default:\r\n        lastTime = 0;\r\n    }\r\n    // 將道具設為 shooter 的狀態\r\n    this.state = propName;\r\n    // 時間到後，移除道具效果\r\n    setTimeout(() => {\r\n      this.state = '';\r\n      // 重新道具計時\r\n      game.generateProp();\r\n    }, lastTime);\r\n    // 顯示道具效果持續時間\r\n    this.displayPropInfo(propName, lastTime);\r\n    if (propName !== 'crackdown') {\r\n      playSound('synth', 'E5');\r\n      playSound('synth', 'G5', '8n', 160);\r\n    }\r\n  }\r\n  // 繪製清場效果\r\n  drawCrackdownEffect() {\r\n    let crackdownTime = 1;\r\n    const boss = game.boss;\r\n    const effect = () => {\r\n      if (!game.isPause) {\r\n        crackdownTime += 1;\r\n      }\r\n      ctx.save();\r\n      ctx.beginPath();\r\n      ctx.shadowColor = 'rgba(255, 255, 255, 0.72)';\r\n      ctx.shadowBlur = 2;\r\n      // 透明度從 1 到 0\r\n      ctx.strokeStyle = `rgba(255, 255, 255, ${(100 - crackdownTime) / 98})`;\r\n      ctx.fillStyle = `rgba(255, 255, 255, ${(100 - crackdownTime) / 490})`;\r\n      ctx.lineWidth = 5;\r\n      /**\r\n       * baseLog() 從 0 到 3\r\n       * 所以 (((crackdownTime - 2) / 98) * 26) + 1 為從 1 到 27\r\n       * 清場半徑因此為從 0 到 528\r\n       */\r\n      const effectR = 176 * baseLog(3, (((crackdownTime - 2) / 98) * 26) + 1);\r\n      ctx.arc(gameW / 2, gameH / 2, effectR, 0, Math.PI * 2);\r\n      ctx.fill();\r\n      ctx.stroke();\r\n      ctx.restore();\r\n      // 清除敵人\r\n      game.circles.forEach((circle, idx) => {\r\n        if (effectR > circle.axisRotateR) {\r\n          enemyMethods.dieEffect(circle.r, originPos(circle.axisRotateR, circle.axisRotateAngle).x, originPos(circle.axisRotateR, circle.axisRotateAngle).y, '245, 175, 95');\r\n          game.circles.splice(idx, 1);\r\n        }\r\n      });\r\n      game.triangles.forEach((triangle, idx) => {\r\n        if (effectR > triangle.axisRotateR) {\r\n          enemyMethods.dieEffect(triangle.r, originPos(triangle.axisRotateR, triangle.axisRotateAngle).x, originPos(triangle.axisRotateR, triangle.axisRotateAngle).y, '54, 118, 187');\r\n          game.triangles.splice(idx, 1);\r\n        }\r\n      });\r\n      game.polygons.forEach((polygon, idx) => {\r\n        if (effectR > polygon.axisRotateR.whole) {\r\n          if (polygon.HP.whole) {\r\n            const polygonWholeR = (34 + 21) / 2;\r\n            enemyMethods.dieEffect(polygonWholeR, polygon.originPos('whole').x, polygon.originPos('whole').y, '231, 70, 93');\r\n          } else {\r\n            if (polygon.HP.big) {\r\n              const polygonBigR = (34 + 22) / 2;\r\n              enemyMethods.dieEffect(polygonBigR, polygon.originPos('big').x, polygon.originPos('big').y, '231, 70, 93');\r\n              game.polygons.splice(idx, 1);\r\n            }\r\n            if (polygon.HP.small) {\r\n              const polygonSmallR = (23 + 21) / 2;\r\n              enemyMethods.dieEffect(polygonSmallR, polygon.originPos('small').x, polygon.originPos('small').y, '231, 70, 93');\r\n              game.polygons.splice(idx, 1);\r\n            }\r\n          }\r\n          game.polygons.splice(idx, 1);\r\n        }\r\n      });\r\n      game.subTris.forEach((subTriangle, idx) => {\r\n        if (effectR > subTriangle.axisRotateR) {\r\n          game.subTris.splice(idx, 1);\r\n        }\r\n      });\r\n      // 清除 boss\r\n      if (game.boss) {\r\n        if (effectR > boss.axisRotateR && boss.HP === 0) {\r\n          enemyMethods.bossDieResult();\r\n        }\r\n      }\r\n      if (crackdownTime < 100) {\r\n        requestAnimationFrame(effect);\r\n      }\r\n    }\r\n    requestAnimationFrame(effect);\r\n    if (boss) {\r\n      boss.HP -= 1;\r\n    }\r\n    // playSound('duo', 'F4', '2n');\r\n    playSound('synth', 'C6', '2n');\r\n    // playSound('synth', 'G2', '8n', 0, 20);\r\n    // playSound('duo', 'F2', '2n', 0, 15);\r\n    // playSound('duo', 'E2', '2n', 0, 10);\r\n    // playSound('duo', 'D2', '8n', 1000, 10);\r\n  }\r\n  // 恢復一個愛心命\r\n  recoverHeart() {\r\n    const heart = document.createElement('DIV');\r\n    heart.classList.add('panel__game-heart');\r\n    heartWrapper.appendChild(heart);\r\n    this.hearts += 1;\r\n  }\r\n  displayPropInfo(propName, lastTime) {\r\n    if (propName === 'crackdown' || propName === 'heart') return;\r\n    // prop.style.opacity = 1;\r\n    prop.classList.remove('op0');\r\n    propImg.src = `../img/${propName}--panel.svg`;\r\n    lastTime /= 1000;  \r\n    propLastTime.textContent = lastTime;\r\n    const countLastTime = () => {\r\n      const propInfoTimer = setTimeout(() => {\r\n        if (game.isPause) {\r\n          countLastTime();\r\n          return;\r\n        }\r\n        // 遊戲結束時，清除計時器\r\n        if (!game.isStart) {\r\n          // prop.style.opacity = 0;\r\n          clearTimeout(propInfoTimer);\r\n          return;\r\n        }\r\n        lastTime -= 1;\r\n        propLastTime.textContent = lastTime >= 10 ? lastTime : `0${lastTime}`;\r\n        if (lastTime) {\r\n          countLastTime();\r\n        } else {\r\n          // prop.style.opacity = 0;\r\n          prop.classList.add('op0');\r\n          clearTimeout(propInfoTimer);\r\n        }\r\n      }, 1000);\r\n    }\r\n    countLastTime();\r\n  }\r\n}\r\n\r\n\r\n\r\nclass ShooterBullet {\r\n  constructor(args) {\r\n    const def = {\r\n      // bodyLen: 15 * 0.85,\r\n      bodyLen: 12.75,\r\n      axisRotateR: 0,\r\n      color: globalColor.white,\r\n      v: 10,\r\n      rotateAngle: 0,\r\n      waveLength: 40,\r\n      waveFreq: 0.2,\r\n      waveAmp: 4,\r\n      waveFlow: 4,\r\n    };\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n  draw() {\r\n    ctx.save();\r\n    ctx.translate(gameW / 2, gameH / 2);\r\n    ctx.rotate(this.rotateAngle);\r\n    // 如果 shooter 狀態非 wave\r\n    if (game.shooter.state !== 'wave') {\r\n      // 殘影\r\n      ctx.beginPath();\r\n      ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';\r\n      // ctx.arc(-7 * 0.85 + this.axisRotateR, 0, 3 * 0.85, 0, Math.PI * 2);\r\n      ctx.arc(-5.95 + this.axisRotateR, 0, 2.15, 0, Math.PI * 2);\r\n      ctx.fill();\r\n      ctx.beginPath();\r\n      ctx.fillStyle = 'rgba(255, 255, 255, 0.4)';\r\n      // ctx.arc(-12 * 0.85 + this.axisRotateR, 0, 2 * 0.85, 0, Math.PI * 2);\r\n      ctx.arc(-10.2 + this.axisRotateR, 0, 1.7, 0, Math.PI * 2);\r\n      ctx.fill();\r\n      ctx.beginPath();\r\n      ctx.fillStyle = 'rgba(255, 255, 255, 0.1)';\r\n      // ctx.arc(-15 * 0.85 + this.axisRotateR, 0, 1 * 0.85, 0, Math.PI * 2);\r\n      ctx.arc(-12.75 + this.axisRotateR, 0, 0.85, 0, Math.PI * 2);\r\n      ctx.fill();\r\n      // 園底\r\n      ctx.beginPath();\r\n      ctx.fillStyle = this.color;\r\n      // ctx.arc(0 + this.axisRotateR, 0, 4 * 0.85, 0, Math.PI * 2);\r\n      ctx.arc(0 + this.axisRotateR, 0, 3.4, 0, Math.PI * 2);\r\n      ctx.fill();\r\n      // 尖頭\r\n      ctx.beginPath();\r\n      // ctx.moveTo(3 * 0.85 + this.axisRotateR, 3 * 0.85);\r\n      ctx.moveTo(2.55 + this.axisRotateR, 2.55);\r\n      ctx.lineTo(this.bodyLen + this.axisRotateR, 0);\r\n      // ctx.lineTo(3 * 0.85 + this.axisRotateR, -3 * 0.85);\r\n      ctx.lineTo(2.55 + this.axisRotateR, -2.55);\r\n      ctx.closePath();\r\n      ctx.fill();\r\n    } else {\r\n      drawWaveBullet(this, 'axisRotateR', 1.6, 'rgba(255, 255, 255, 0.72)');\r\n    }\r\n    ctx.restore();\r\n  }\r\n  update(bulletIdx) {\r\n    // 移動子彈\r\n    this.axisRotateR += this.v;\r\n    let anglePanFn;\r\n    let shotRRangeFn;\r\n    // 判斷子彈為哪一類型\r\n    // 一般類型\r\n    if (game.shooter.state !== 'wave') {\r\n      const bulletMoveLen = this.axisRotateR + this.bodyLen;\r\n      // 判斷子彈有無射中圓形\r\n      game.circles.forEach((circle, cirIdx) => {\r\n        anglePanFn = () => {\r\n          return Math.asin(circle.r / circle.axisRotateR);\r\n        }\r\n        shotRRangeFn = () => {\r\n          return (bulletMoveLen >= (circle.axisRotateR - (circle.r / 2))) && (bulletMoveLen <= (circle.axisRotateR + (circle.r / 2)));\r\n        }\r\n        this.attackEnemy(circle, cirIdx, game.circles, bulletIdx, anglePanFn, shotRRangeFn, '245, 175, 95');\r\n      });\r\n      // 判斷子彈有無射中三角形\r\n      game.triangles.forEach((triangle, triIdx) => {\r\n        anglePanFn = () => {\r\n          const lengthX = triangle.axisRotateR + (triangle.r / 2);\r\n          const lengthY = (triangle.r / 2) * Math.sqrt(3);\r\n          return Math.atan2(lengthY, lengthX);\r\n        }\r\n        shotRRangeFn = () => {\r\n          return (bulletMoveLen >= triangle.axisRotateR) && (bulletMoveLen <= (triangle.axisRotateR + (triangle.r / 2)));\r\n        }\r\n        this.attackEnemy(triangle, triIdx, game.triangles, bulletIdx, anglePanFn, shotRRangeFn, '54, 118, 187');\r\n      });\r\n      // 判斷子彈有無射中多邊形\r\n      game.polygons.forEach((polygon, polyIdx) => {\r\n        // 當多邊形未分裂\r\n        if (polygon.HP.whole) {\r\n          shotRRangeFn = () => {\r\n            const sideA = polygon.axisRotateR.whole;\r\n            return (bulletMoveLen >= sideA) && (bulletMoveLen <= (sideA + 9));\r\n          }\r\n          this.attackPolygon(polygon, polyIdx, 'whole', 34, 21, (360 - (202 + 75)), (8 + 75), 75, bulletIdx, shotRRangeFn);\r\n        } else {\r\n          // 當多邊形分裂\r\n          // 大分裂\r\n          if (polygon.HP.big) {\r\n            shotRRangeFn = () => {\r\n              const sideA = polygon.axisRotateR.big;\r\n              return (bulletMoveLen >= sideA + 8) && (bulletMoveLen <= (sideA + 16));\r\n            }\r\n            this.attackPolygon(polygon, polyIdx, 'big', 34, 23, ((202 + 44) - 180), (180 - (70 + 44)), 44, bulletIdx, shotRRangeFn);\r\n          }\r\n          // 小分裂\r\n          if (polygon.HP.small) {\r\n            shotRRangeFn = () => {\r\n              const sideA = polygon.axisRotateR.small;\r\n              return (bulletMoveLen >= sideA + 8) && (bulletMoveLen <= (sideA + 16));\r\n            }\r\n            this.attackPolygon(polygon, polyIdx, 'small', 22, 23, ((255 + 17.5) - 180), (180 - (70 + 17.5)), 17.5, bulletIdx, shotRRangeFn);\r\n          }\r\n        }\r\n      });\r\n      // 判斷子彈有無射中 boss\r\n      const boss = game.boss;\r\n      if (boss) {\r\n        anglePanFn = () => {\r\n          return Math.asin(18 / (boss.axisRotateR + 6));\r\n        }\r\n        shotRRangeFn = () => {\r\n          return (bulletMoveLen >= (boss.axisRotateR + 9 + 8)) && (bulletMoveLen <= (boss.axisRotateR + 28));\r\n        }\r\n        this.attackEnemy(boss, NaN, null, bulletIdx, anglePanFn, shotRRangeFn, '255, 255, 255', 'ordinary', true);\r\n      }\r\n    } else {\r\n      // 波狀類型\r\n      // 有無射中圓形\r\n      game.circles.forEach((circle, cirIdx) => {\r\n        anglePanFn = () => {\r\n          return Math.asin(circle.r / circle.axisRotateR);\r\n        }\r\n        shotRRangeFn = () => {\r\n          return (this.axisRotateR >= (circle.axisRotateR - (circle.r / 2))) && (this.axisRotateR <= (circle.axisRotateR + (circle.r / 2)));\r\n        }\r\n        this.attackEnemy(circle, cirIdx, game.circles, bulletIdx, anglePanFn, shotRRangeFn, '245, 175, 95', 'wave');\r\n      });\r\n      // 有無射中三角形\r\n      game.triangles.forEach((triangle, triIdx) => {\r\n        anglePanFn = () => {\r\n          const lengthX = triangle.axisRotateR + (triangle.r / 2);\r\n          const lengthY = (triangle.r / 2) * Math.sqrt(3);\r\n          return Math.atan2(lengthY, lengthX);\r\n        }\r\n        shotRRangeFn = () => {\r\n          return (this.axisRotateR >= triangle.axisRotateR) && (this.axisRotateR <= (triangle.axisRotateR + (triangle.r / 2)));\r\n        }\r\n        this.attackEnemy(triangle, triIdx, game.triangles, bulletIdx, anglePanFn, shotRRangeFn, '54, 118, 187', 'wave');\r\n      });\r\n      // 有無射中多邊形\r\n      game.polygons.forEach((polygon, polyIdx) => {\r\n        // 當多邊形尚未分裂\r\n        if (polygon.HP.whole) {\r\n          shotRRangeFn = () => {\r\n            const sideA = polygon.axisRotateR.whole;\r\n            return (this.axisRotateR >= sideA) && (this.axisRotateR <= (sideA + 9));\r\n          }\r\n          this.attackPolygon(polygon, polyIdx, 'whole', 34, 21, (360 - (202 + 75)), (8 + 75), 75, bulletIdx, shotRRangeFn, 'wave');\r\n        } else {\r\n          // 當多邊形已經分裂\r\n          // 大分裂\r\n          if (polygon.HP.big) {\r\n            shotRRangeFn = () => {\r\n              const sideA = polygon.axisRotateR.big;\r\n              return (this.axisRotateR >= sideA + 8) && (this.axisRotateR <= (sideA + 16));\r\n            }\r\n            this.attackPolygon(polygon, polyIdx, 'big', 34, 23, ((202 + 44) - 180), (180 - (70 + 44)), 44, bulletIdx, shotRRangeFn, 'wave');\r\n          }\r\n          // 小分裂\r\n          if (polygon.HP.small) {\r\n            shotRRangeFn = () => {\r\n              const sideA = polygon.axisRotateR.small;\r\n              return (this.axisRotateR >= sideA + 8) && (this.axisRotateR <= (sideA + 16));\r\n            }\r\n            this.attackPolygon(polygon, polyIdx, 'small', 22, 23, ((255 + 17.5) - 180), (180 - (70 + 17.5)), 17.5, bulletIdx, shotRRangeFn, 'wave');\r\n          }\r\n          // 如果大小分裂都已被擊斃，移除此多邊形\r\n          if (polygon.HP.big === 0 && polygon.HP.small === 0) {\r\n            game.polygons.splice(polyIdx, 1);\r\n            // 電池加一\r\n            game.batteryNum += 1;\r\n            batteryNum.textContent = game.batteryNum;\r\n          }\r\n        }\r\n      });\r\n      // 判斷子彈有無射中 boss\r\n      const boss = game.boss;\r\n      if (boss) {\r\n        anglePanFn = () => {\r\n          return Math.asin(18 / (boss.axisRotateR + 6));\r\n        }\r\n        shotRRangeFn = () => {\r\n          return (this.axisRotateR >= (boss.axisRotateR + 9 + 8)) && (this.axisRotateR <= (boss.axisRotateR + 28));\r\n        }\r\n        this.attackEnemy(boss, NaN, null, bulletIdx, anglePanFn, shotRRangeFn, '255, 255, 255', 'wave', true);\r\n      }\r\n    }\r\n    // 當子彈超出邊界\r\n    this.beyondBoundary(bulletIdx);\r\n  }\r\n  // 攻擊敵人（圓形、三角形）\r\n  // FIXME 當敵人太靠近會打不到\r\n  attackEnemy(enemy, enemyIdx, enemies, bulletIdx, anglePanFn, shotRRangeFn, colorRGB, type = 'ordinary', isBoss = false) {\r\n    /**\r\n     * 射中角度範圍\r\n     * 圓形：取得兩個外切線所構成角度的一半\r\n     * 三角形：取得射中角度範圍的一半\r\n     */\r\n    const enemyAnglePan = anglePanFn();\r\n    const enemyAngleMinus = (enemy.axisRotateAngle % 360) * degToPi - enemyAnglePan;\r\n    const enemyAngleAdd = (enemy.axisRotateAngle % 360) * degToPi + enemyAnglePan;\r\n    const shotAngleRange = this.judgeShotAngleRange(enemyAngleMinus, enemyAngleAdd, type);\r\n    // 射中距離範圍\r\n    const shotRRange = shotRRangeFn();\r\n\r\n    if (!gameCrawler.textContent) {\r\n      gameCrawler.textContent = Math.random() >= 0.5 ? 'FIRE🔥' : 'BANG👊';\r\n    }\r\n    // 判斷子彈有無射中敵人\r\n    if (shotAngleRange && shotRRange) {\r\n      // 移除子彈\r\n      game.shooter.bullets.splice(bulletIdx, 1);\r\n      // 扣敵人 1 生命值\r\n      enemy.HP -= 1;\r\n      if (type === 'ordinary') {\r\n        playSound('membrane', 'D2');\r\n      } else {\r\n        playSound('mono', 'C2', '8n', 0, -10);\r\n      }\r\n      // 若敵人生命值為 0\r\n      if (enemy.HP === 0) {\r\n        if (isBoss) {\r\n          // 移除 boss\r\n          enemyMethods.bossDieResult();\r\n          return;\r\n        } else {\r\n          // 移除敵人\r\n          enemies.splice(enemyIdx, 1);\r\n          // 移除效果\r\n          enemyMethods.dieEffect(enemy.r, originPos(enemy.axisRotateR, enemy.axisRotateAngle).x, originPos(enemy.axisRotateR, enemy.axisRotateAngle).y, colorRGB);\r\n          // 電池加一\r\n          game.batteryNum += 1;\r\n          batteryNum.textContent = game.batteryNum;\r\n        }\r\n      }\r\n      gameCrawler.textContent = Math.random() >= 0.8 ? \"BULL'S-EYE😤\" : 'HIT👍';\r\n    }\r\n  }\r\n  // 攻擊多邊形\r\n  attackPolygon(polygon, polyIdx, form, sideB1Len, sideB2Len, angleAB1, angleAB2, rotateAngleJudge, bulletIdx, shotRRangeFn, type = 'ordinary') {\r\n    const polyAxisRotateAngle = polygon.axisRotateAngle[form];\r\n    const polyRotate = polygon.rotate[form];\r\n    // 取得兩側射中最大角度\r\n    const sideA = polygon.axisRotateR[form];\r\n    const sideB1 = sideB1Len;\r\n    const sideB2 = sideB2Len;\r\n    /**\r\n     * 兩側點愈靠近軸心，夾角便愈大\r\n     *   whole: 8°, 202°\r\n     *   big: 70°, 202°\r\n     *   small: 70°, 255°\r\n\r\n     * 相同軸半徑下，當多邊形呈某一角度，兩側點離軸心（幾乎）最近，angleB 相同\r\n     *   whole: axisRotateAngle 180°, rotate 75°\r\n     *     270 - 202 = 68\r\n     *     90 - 8 = 82\r\n     *     (68 + 82) / 2 = 75\r\n     * \r\n     *   big: axisRotateAngle 0°, rotate 44°\r\n     *     270 - 202 = 68\r\n     *     90 - 70 = 20\r\n     *     (68 + 20) / 2 = 44\r\n     * \r\n     *   small: axisRotateAngle 0°, rotate 17.5°\r\n     *     270 - 255 = 15\r\n     *     90 - 70 = 20\r\n     *     (15 + 20) / 2 = 17.5\r\n     */\r\n    const sideC1 = cosineFormula(sideA, sideB1, angleAB1);\r\n    const sideC2 = cosineFormula(sideA, sideB2, angleAB2);\r\n    // 當多邊形的 axisRotateAngle、rotate 不同，要加上與減去的角度也不一樣\r\n    const bottomJudge = (polyAxisRotateAngle <= 180) && ((polyRotate % 360) < rotateAngleJudge || (polyRotate % 360) >= (rotateAngleJudge + 180));\r\n    const topJudge = (polyAxisRotateAngle > 180) && ((polyRotate % 360) >= rotateAngleJudge || (polyRotate % 360) < (rotateAngleJudge + 180));\r\n    let angleB1;\r\n    let angleB2;\r\n\r\n    if (!gameCrawler.textContent) {\r\n      gameCrawler.textContent = Math.random() >= 0.5 ? 'FIRE🔥' : 'BANG👊';\r\n    }\r\n    if (bottomJudge || topJudge) {\r\n      angleB1 = getAngleB(sideA, sideB2, sideC2);\r\n      angleB2 = getAngleB(sideA, sideB1, sideC1);\r\n    } else {\r\n      angleB1 = getAngleB(sideA, sideB1, sideC1);\r\n      angleB2 = getAngleB(sideA, sideB2, sideC2);\r\n    }\r\n    /**\r\n     * 射中角度範圍\r\n     * 多邊形雖不會繞軸旋轉，axisRotateAngle 固定，但分裂時可能會超過 360°，故 % 360\r\n     */\r\n    const polyAngleMinus = (polyAxisRotateAngle % 360) * degToPi - angleB1;\r\n    const polyAngleAdd = (polyAxisRotateAngle % 360) * degToPi + angleB2;\r\n    const shotAngleRange = this.judgeShotAngleRange(polyAngleMinus, polyAngleAdd, type);\r\n    // 射中距離範圍\r\n    const shotRRange = shotRRangeFn();\r\n    // 判斷子彈有無射中多邊形\r\n    if (shotAngleRange && shotRRange) {\r\n      // 移除子彈\r\n      game.shooter.bullets.splice(bulletIdx, 1);\r\n      // 扣 1 生命值\r\n      polygon.HP[form] -= 1;\r\n      if (form === 'whole') {\r\n        playSound('synth', 'D6', '16n');\r\n      }\r\n      // 若大或小分裂生命值為 0\r\n      if (polygon.HP.big === 0 || polygon.HP.small === 0) {\r\n        // 移除效果\r\n        const polygonR = form === 'big' ? (34 + 22) / 2 : (23 + 21) / 2;\r\n        enemyMethods.dieEffect(polygonR, polygon.originPos(form).x, polygon.originPos(form).y, '231, 70, 93');\r\n      }\r\n      // 如果大小分裂都被擊斃了，那就移除此多邊形\r\n      if (polygon.HP.big === 0 && polygon.HP.small === 0) {\r\n        game.polygons.splice(polyIdx, 1);\r\n        // 電池加一\r\n        game.batteryNum += 1;\r\n        batteryNum.textContent = game.batteryNum;\r\n      }\r\n      gameCrawler.textContent = Math.random() >= 0.8 ? \"BULL'S-EYE😤!\" : 'HIT👍';\r\n      if (type === 'ordinary') {\r\n        playSound('membrane', 'D2');\r\n      } else {\r\n        playSound('mono', 'C2', '8n', 0, -10);\r\n      }\r\n    }\r\n  }\r\n  // 判斷射中角度範圍\r\n  judgeShotAngleRange(enemyAngleMinus, enemyAngleAdd, type) {\r\n    let shooterRotateAngle;\r\n    // 當敵人 axisRotateAngle 在 360° 附近，且 shooter 槍口朝下（0° 下方）\r\n    if (enemyAngleAdd > Math.PI * 2 && this.rotateAngle < Math.PI) {\r\n      shooterRotateAngle = this.rotateAngle + Math.PI * 2;\r\n    } else if (\r\n      // 當敵人 axisRotateAngle 皆小於 0\r\n      (enemyAngleMinus < 0 && enemyAngleAdd < 0) || \r\n      // 當敵人 axisRotateAngle 在 0° 附近，且 shooter 槍口朝上（0° 上方）\r\n      (enemyAngleMinus < 0 && enemyAngleAdd > 0 && this.rotateAngle > Math.PI)) {\r\n      shooterRotateAngle = this.rotateAngle - Math.PI * 2;\r\n    } else {\r\n      shooterRotateAngle = this.rotateAngle;\r\n    }\r\n    // 判斷子彈為哪一類型\r\n    // 一般子彈\r\n    if (type !== 'wave') {\r\n      return shooterRotateAngle >= enemyAngleMinus && shooterRotateAngle <= enemyAngleAdd;\r\n    } else {\r\n      // 波狀子彈\r\n      const shooterAnglePan = Math.atan2(this.waveLength, this.axisRotateR);\r\n      const shooterAngleMinus = shooterRotateAngle - shooterAnglePan;\r\n      const shooterAngleAdd = shooterRotateAngle + shooterAnglePan;\r\n      return (enemyAngleMinus <= shooterAngleAdd) && (enemyAngleAdd >= shooterAngleMinus);\r\n    }\r\n  }\r\n  // 當子彈超出邊界\r\n  beyondBoundary(bulletIdx) {\r\n    /**\r\n     * 856 / 2 = 428\r\n     * 624 / 2 = 312\r\n     * Math.sqrt(428 * 428 + 312 * 312) = 529.6\r\n     */\r\n    if (this.axisRotateR >= 530) {\r\n      game.shooter.bullets.splice(bulletIdx, 1);\r\n    }\r\n  }\r\n}","class Triangle {\r\n  constructor(args) {\r\n    const def = {\r\n      axisRotateR: 0,\r\n      axisRotateAngle: 0,\r\n      r: 26,\r\n      rotate: 0,\r\n      scale: 0,\r\n      axisRotateRV: 0,\r\n      axisRotateAngleV: 0,\r\n      color: globalColor.blue,\r\n      bullets: [],\r\n      beforeRotateAxisAngleTime: new Date(),\r\n      beforeShootTime: new Date(),\r\n      HP: 4,\r\n      isGeneratedSub: false,\r\n      shootTimer: null,\r\n      beginAppear: true,\r\n      isBossGenerate: false,\r\n    }\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n\r\n\r\n  \r\n  draw() {\r\n    const triOuterBigR = this.r + 4;\r\n    const triInnerBigR = this.r - 16;\r\n    const triInnerSmallR = this.r - 22;\r\n    ctx.save();\r\n    // 淡三角\r\n    ctx.translate(originPos(this.axisRotateR, this.axisRotateAngle).x, originPos(this.axisRotateR, this.axisRotateAngle).y);\r\n    ctx.scale(this.scale, this.scale);\r\n    ctx.rotate(this.rotate * degToPi);\r\n    ctx.save();\r\n    ctx.translate(4, 0);\r\n    ctx.beginPath();\r\n    ctx.moveTo(triOuterBigR * Math.cos(60 * degToPi), triOuterBigR * Math.sin(60 * degToPi));\r\n    ctx.$triLineTo(triOuterBigR, 180);\r\n    ctx.$triLineTo(triOuterBigR, 300);\r\n    ctx.closePath();\r\n    ctx.fillStyle = 'rgba(54, 118, 187, 0.34)';\r\n    ctx.fill();\r\n    ctx.restore();\r\n    // 主體三角\r\n    ctx.beginPath();\r\n    ctx.moveTo(this.r * Math.cos(60 * degToPi), this.r * Math.sin(60 * degToPi));\r\n    ctx.$triLineTo(this.r, 180);\r\n    ctx.$triLineTo(this.r, 300);\r\n    ctx.closePath();\r\n    ctx.fillStyle = this.color;\r\n    ctx.fill();\r\n    // 大白三角\r\n    ctx.translate(0, -2.8);\r\n    ctx.fillStyle = globalColor.white;\r\n    ctx.beginPath();\r\n    ctx.moveTo(0, 0);\r\n    ctx.$triLineTo(triInnerBigR, 90);\r\n    ctx.$triLineTo(triInnerBigR, 150);\r\n    ctx.closePath();\r\n    ctx.fill();\r\n    // 小白三角\r\n    ctx.translate(8 * Math.cos(-40 * degToPi), 8 * Math.sin(-40 * degToPi))\r\n    ctx.beginPath();\r\n    ctx.moveTo(0, 0);\r\n    ctx.$triLineTo(triInnerSmallR, 90);\r\n    ctx.$triLineTo(triInnerSmallR, 150);\r\n    ctx.closePath();\r\n    ctx.fill();\r\n    ctx.restore();\r\n    // 繪製三角子彈\r\n    this.bullets.forEach((bullet) => {\r\n      bullet.draw();\r\n    });\r\n  }\r\n\r\n\r\n\r\n  update(idx) {\r\n    this.beginAppear && this.appear(this.isBossGenerate);\r\n    this.beginAppear = false;\r\n    game.isStart && enemyMethods.approach(this);\r\n    // 更新三角子彈\r\n    this.bullets.forEach((bullet, idx, arr) => {\r\n      bullet.update(idx, arr);\r\n    });\r\n    // 每 4-8 秒，三角移動 + 自身旋轉\r\n    const rotateAxisAngleTime = new Date();\r\n    let randomRotateAngle;\r\n    if (rotateAxisAngleTime - this.beforeRotateAxisAngleTime > getRandom(4000, 8000)) {\r\n      // 旋轉時不發射子彈\r\n      if (this.shootTimer) {\r\n        clearTimeout(this.shootTimer);\r\n      }\r\n      randomRotateAngle = (Math.random() >= 0.25 ? 1 : -1) * getRandom(45, 75);\r\n      // 以 0.8 秒移動\r\n      TweenLite.to(this, 0.8, {\r\n        axisRotateAngle: `+=${randomRotateAngle}`,\r\n        ease: Power0.easeNone,\r\n      });\r\n      // 以 1.2 秒自身旋轉\r\n      TweenLite.to(this, 1.2, {\r\n        rotate: `+=${randomRotateAngle + 360}`,\r\n        ease: Power2.easeInOut,\r\n        onComplete: () => {\r\n          // 移動完後發射子彈\r\n          // 當遊戲尚未開始、暫停，或此三角形已死掉，便不發射子彈\r\n          if (!game.isStart || game.isPause || this.HP === 0) return;\r\n          this.shoot();\r\n          // 發射一顆子彈後，每 2.4-7.2 秒發射第二發子彈\r\n          this.shootTimer = setTimeout(() => {\r\n            if (!game.isStart || this.HP === 0) return;\r\n            this.shoot();\r\n          }, getRandom(2400, 7200));\r\n        }\r\n      });\r\n      this.beforeRotateAxisAngleTime = rotateAxisAngleTime;\r\n    }\r\n    // 當生命值剩 2，派副三角形攻擊\r\n    if (this.HP === 2 && !this.isGeneratedSub) {\r\n      for (let i = 1; i <= 2; i += 1) {\r\n        game.subTris.push(new TriSub({\r\n          axisRotateR: this.axisRotateR,\r\n          axisRotateAngle: this.axisRotateAngle,\r\n          rotate: this.rotate,\r\n          order: i,\r\n        }));\r\n      }\r\n      gameCrawler.textContent = 'COUNTERATTACK🤛';\r\n      this.isGeneratedSub = true;\r\n      playSound('synth', 'C6', '16n');\r\n    }\r\n    // 當三角形撞上 shooter\r\n    enemyMethods.hitShooter(game.triangles, idx, 'triangle', this.axisRotateR, this.axisRotateAngle);\r\n  }\r\n\r\n\r\n\r\n  shoot() {\r\n    this.bullets.push(new TriBullet({\r\n      p: {\r\n        x: originPos(this.axisRotateR, this.axisRotateAngle).x,\r\n        y: originPos(this.axisRotateR, this.axisRotateAngle).y,\r\n      },\r\n      axisRotateR: this.axisRotateR,\r\n      rotateAngle: this.rotate,\r\n    }));\r\n    gameCrawler.textContent = Math.random() >= 0.8 ? 'UNDER ATTACK🤕' : 'ATTACK⚡️';\r\n    playSound('membrane', 'G5');\r\n  }\r\n\r\n\r\n\r\n  appear(isBossGenerate) {\r\n    gameCrawler.textContent = '⚠ ENEMY IS COMING';\r\n    TweenLite.to(this, 0.8, {\r\n      scale: 1,\r\n      ease: Back.easeOut.config(1.7),\r\n    });\r\n    let rotateNum = 0;\r\n    if (isBossGenerate) {\r\n      rotateNum = getRandom(40, 80);\r\n      const rNum = getRandom(40, 80);\r\n      TweenLite.to(this, 1.6, {\r\n        axisRotateAngle: `+=${rotateNum}`,\r\n        axisRotateR: `+=${rNum}`,\r\n        ease: Power2.easeOut,\r\n      });\r\n    }\r\n    TweenLite.to(this, 1.6, {\r\n      rotate: `+=${rotateNum + 360}`,\r\n      ease: Back.easeOut.config(1.7),\r\n    });\r\n    game.isStart && playSound('synth', 'B4', '4n');\r\n  }\r\n}\r\n\r\n\r\n\r\nclass TriSub {\r\n  constructor(args) {\r\n    const def = {\r\n      axisRotateR: 0,\r\n      axisRotateAngle: 0,\r\n      // r: 26 * 0.4,\r\n      r: 10.4,\r\n      rotate: 0,\r\n      rotateV: 4,\r\n      color: globalColor.blue,\r\n      HP: 2,\r\n      isReproduceMoving: false,\r\n      order: 0,\r\n    }\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n  draw() {\r\n    const triOuterBigR = this.r + 1.6;\r\n    const triInnerBigR = this.r - 6.4;\r\n    const triInnerSmallR = this.r - 8.8;\r\n    ctx.save();\r\n    // 淡三角\r\n    ctx.translate(originPos(this.axisRotateR, this.axisRotateAngle).x, originPos(this.axisRotateR, this.axisRotateAngle).y);\r\n    // ctx.scale(0.4, 0.4);\r\n    ctx.rotate(this.rotate * degToPi);\r\n    ctx.save();\r\n    ctx.translate(0.8, -Math.sqrt(1.92));\r\n    ctx.beginPath();\r\n    ctx.moveTo(triOuterBigR * Math.cos(0), triOuterBigR * Math.sin(0));\r\n    ctx.lineTo(triOuterBigR * Math.cos(120 * degToPi), triOuterBigR * Math.sin(120 * degToPi));\r\n    ctx.lineTo(triOuterBigR * Math.cos(240 * degToPi), triOuterBigR * Math.sin(240 * degToPi));\r\n    ctx.closePath();\r\n    ctx.fillStyle = 'rgba(54, 118, 187, 0.34)';\r\n    ctx.fill();\r\n    ctx.restore();\r\n    // 主體三角\r\n    ctx.beginPath();\r\n    ctx.moveTo(this.r * Math.cos(0), this.r * Math.sin(0));\r\n    ctx.lineTo(this.r * Math.cos(120 * degToPi), this.r * Math.sin(120 * degToPi));\r\n    ctx.lineTo(this.r * Math.cos(240 * degToPi), this.r * Math.sin(240 * degToPi));\r\n    ctx.closePath();\r\n    ctx.fillStyle = this.color;\r\n    ctx.fill();\r\n    // 大白三角\r\n    ctx.translate(-1.28, -0.64);\r\n    ctx.fillStyle = globalColor.white;\r\n    ctx.beginPath();\r\n    ctx.moveTo(0, 0);\r\n    ctx.lineTo(triInnerBigR * Math.cos(30 * degToPi), triInnerBigR * Math.sin(30 * degToPi));\r\n    ctx.lineTo(triInnerBigR * Math.cos(90 * degToPi), triInnerBigR * Math.sin(90 * degToPi));\r\n    ctx.closePath();\r\n    ctx.fill();\r\n    // 小白三角\r\n    ctx.translate(0, -3.52);\r\n    ctx.beginPath();\r\n    ctx.moveTo(0, 0);\r\n    ctx.lineTo(triInnerSmallR * Math.cos(30 * degToPi), triInnerSmallR * Math.sin(30 * degToPi));\r\n    ctx.lineTo(triInnerSmallR * Math.cos(90 * degToPi), triInnerSmallR * Math.sin(90 * degToPi));\r\n    ctx.closePath();\r\n    ctx.fill();\r\n    ctx.restore();\r\n  }\r\n  update(idx) {\r\n    this.rotate += this.rotateV;\r\n    if (!this.isReproduceMoving) {\r\n      TweenLite.to(this, 0.8, {\r\n        axisRotateAngle: `${this.order === 1 ? '+=' : '-='}10`,\r\n        ease: Power2.easeOut,\r\n        onComplete: () => {\r\n          TweenLite.to(this, 1.6, {\r\n            axisRotateR: 0,\r\n            ease: Power1.easeIn,\r\n          });\r\n        }\r\n      });\r\n      this.isReproduceMoving = true;\r\n    }\r\n    // 當小三角形撞上 shooter\r\n    enemyMethods.hitShooter(game.subTris, idx, 'triangle', this.axisRotateR, this.axisRotateAngle);\r\n  }\r\n}\r\n\r\n\r\n\r\nclass TriBullet {\r\n  constructor(args) {\r\n    const def = {\r\n      p: {\r\n        x: 0,\r\n        y: 0,\r\n      },\r\n      moveX: 0,\r\n      moveXV: -4.5,\r\n      rotateAngle: 0,\r\n      color: globalColor.blue,\r\n    }\r\n    Object.assign(def, args);\r\n    Object.assign(this, def);\r\n  }\r\n  draw() {\r\n    ctx.save();\r\n    ctx.translate(this.p.x, this.p.y);\r\n    ctx.rotate(this.rotateAngle * degToPi);\r\n    ctx.translate(this.moveX, 0);\r\n    // 主體三角子彈\r\n    ctx.fillStyle = this.color;\r\n    ctx.beginPath();\r\n    ctx.moveTo(-16, 0);\r\n    ctx.$triLineTo(38, 174);\r\n    ctx.$triLineTo(16.8, 200);\r\n    ctx.closePath();\r\n    ctx.fill();\r\n    // 淡三角子彈\r\n    ctx.fillStyle = 'rgba(54, 118, 187, 0.34)';\r\n    ctx.beginPath();\r\n    ctx.moveTo(-16.4, 0);\r\n    ctx.$triLineTo(38, 174);\r\n    ctx.$triLineTo(15.6, 168);\r\n    ctx.closePath();\r\n    ctx.fill();\r\n    ctx.restore();\r\n  }\r\n  update(idx, arr) {\r\n    // 三角子彈移動\r\n    this.moveX += this.moveXV;\r\n    // 子彈擊中 shooter\r\n    enemyMethods.attackShooter(this, idx, arr, 37.8);\r\n    // 當子彈超出邊界\r\n    this.beyondBoundary(idx, arr);\r\n  }\r\n  // 當子彈超出邊界\r\n  beyondBoundary(idx, arr) {\r\n    // Math.sqrt(856 * 856 + 624 * 624) = 1059.3\r\n    if (this.moveX <= -1060) {\r\n      arr.splice(idx, 1);\r\n    }\r\n  }\r\n}","ctx.$triLineTo = function (r, angle, angleAdd = 0) {\r\n  return ctx.lineTo(r * Math.cos(angle * degToPi + angleAdd), r * Math.sin(angle * degToPi + angleAdd));\r\n}\r\n\r\n// 繪製波狀子彈\r\nfunction drawWaveBullet(bullet, originPos, lineWidth, shadowColor) {\r\n  ctx.strokeStyle = bullet.color;\r\n  ctx.lineWidth = lineWidth;\r\n  ctx.shadowColor = shadowColor;\r\n  ctx.shadowBlur = 2;\r\n  // 正半波\r\n  ctx.beginPath();\r\n  for (let i = 0; i < bullet.waveLength; i += 1) {\r\n    const degree = (i * bullet.waveFreq) + (updateTime / bullet.waveFlow);\r\n    ctx.lineTo(bullet[originPos] + (bullet.waveAmp * Math.sin(degree)), i);\r\n  }\r\n  ctx.stroke();\r\n  // 負半波\r\n  ctx.beginPath();\r\n  for (let i = 0; i < bullet.waveLength; i += 1) {\r\n    const degree = (i * bullet.waveFreq) + (updateTime / bullet.waveFlow);\r\n    ctx.lineTo(bullet[originPos] + (bullet.waveAmp * Math.sin(degree)), -i);\r\n  }\r\n  ctx.stroke();\r\n}\r\n\r\n// 繪製電池\r\n// function drawBattery(p) {\r\n//   ctx.save();\r\n//     ctx.translate(p.x, p.y);\r\n//     ctx.fillStyle = globalColor.orange;\r\n//     // 瓶身\r\n//     ctx.beginPath();\r\n//     ctx.moveTo(0, 0);\r\n//     ctx.lineTo(-24, 0);\r\n//     ctx.lineTo(-24, 42);\r\n//     ctx.lineTo(0, 42);\r\n//     ctx.closePath();\r\n//     ctx.fill();\r\n//     // 瓶底\r\n//     ctx.save();\r\n//       ctx.translate(0, 44);\r\n//       ctx.beginPath();\r\n//       ctx.moveTo(0, 0);\r\n//       ctx.lineTo(-24, 0);\r\n//       ctx.lineTo(-24, 3);\r\n//       ctx.lineTo(0, 3);\r\n//       ctx.closePath();\r\n//       ctx.fill();\r\n//     ctx.restore();\r\n//     // 瓶蓋\r\n//     ctx.fillStyle = globalColor.white;\r\n//     ctx.save();\r\n//       ctx.translate(-6.75, 0);\r\n//       ctx.beginPath();\r\n//       ctx.moveTo(0, 0);\r\n//       ctx.lineTo(0, -3);\r\n//       ctx.lineTo(-10.5, -3);\r\n//       ctx.lineTo(-10.5, -0);\r\n//       ctx.closePath();\r\n//       ctx.fill();\r\n//     ctx.restore();\r\n//     // 閃電\r\n//     drawLightning({ x: -11, y: 9 });\r\n//   ctx.restore();\r\n// }\r\n\r\n\r\n\r\n// 繪製閃電\r\nfunction drawLightning(translate = { x: 0, y: 0 }, scale = 1) {\r\n  ctx.fillStyle = globalColor.white;\r\n  ctx.translate(translate.x, translate.y);\r\n  ctx.beginPath();\r\n  ctx.moveTo(0, 0);\r\n  ctx.rotate(18 * degToPi);\r\n  ctx.lineTo(0, 10 * scale);\r\n  ctx.translate(0, 10 * scale);\r\n  ctx.rotate(-18 * degToPi);\r\n\r\n  ctx.lineTo(10 * scale, 0);\r\n  ctx.translate(10 * scale, 0);\r\n\r\n  ctx.rotate(28 * degToPi);\r\n  ctx.lineTo(0, 16 * scale);\r\n  ctx.translate(0, 16 * scale);\r\n  ctx.rotate(-28 * degToPi);\r\n\r\n  ctx.rotate(3.6 * degToPi);\r\n  ctx.lineTo(0, -10 * scale);\r\n  ctx.translate(0, -10 * scale);\r\n  ctx.rotate(-3.6 * degToPi);\r\n\r\n  ctx.lineTo(-8 * scale, 0);\r\n  ctx.closePath();\r\n  ctx.fill();\r\n}\r\n\r\n\r\n\r\nfunction originPos(axisRotateR, axisRotateAngle) {\r\n  return {\r\n    x: (gameW / 2) + axisRotateR * Math.cos(axisRotateAngle * degToPi),\r\n    y: (gameH / 2) + axisRotateR * Math.sin(axisRotateAngle * degToPi),\r\n  };\r\n}\r\n\r\n\r\n\r\n// 以 x 為底的 y 的對數：logxy\r\nfunction baseLog(x, y) {\r\n  return Math.log(y) / Math.log(x);\r\n}\r\n\r\n\r\n\r\n// 餘弦定理\r\nfunction cosineFormula(a, b, angle) {\r\n  return Math.sqrt(a * a + b * b - 2 * a * b * Math.cos(angle * degToPi));\r\n}\r\n\r\nfunction getAngleB(a, b, c) {\r\n  return Math.acos((a * a + c * c - b * b) / (2 * a * c));\r\n}\r\n\r\n\r\n\r\n// 取得某區間的隨機亂數\r\nfunction getRandom(min, max) {\r\n  return Math.floor(Math.random() * (max - min + 1) + min);\r\n}\r\n\r\n\r\n\r\nfunction playSound(instrument, note, duration = '8n', timeout = 0, volume = 0) {\r\n  if (game.isMuted) return;\r\n  let synth;\r\n  switch (instrument) {\r\n    case 'membrane':\r\n      setTimeout(() => {\r\n        synth = new Tone.MembraneSynth().toMaster();\r\n        synth.triggerAttackRelease(note, duration);\r\n        synth.volume.value = volume;\r\n      }, timeout);\r\n      break;\r\n    case 'duo':\r\n      setTimeout(() => {\r\n        synth = new Tone.DuoSynth().toMaster();\r\n        synth.triggerAttackRelease(note, duration);\r\n        synth.volume.value = volume;\r\n      }, timeout);\r\n      break;\r\n    case 'mono':\r\n      setTimeout(() => {\r\n        synth = new Tone.MonoSynth().toMaster();\r\n        synth.triggerAttackRelease(note, duration);\r\n        synth.volume.value = volume;\r\n      }, timeout);\r\n      break;\r\n    default:\r\n      setTimeout(() => {\r\n        synth = new Tone.Synth().toMaster();\r\n        synth.triggerAttackRelease(note, duration);\r\n        synth.volume.value = volume;\r\n      }, timeout);\r\n      break;\r\n  }\r\n}\r\n\r\n\r\n/* 2D Vector Class */\r\n// class Vec2 {\r\n//   constructor(x, y) {\r\n//     this.x = x;\r\n//     this.y = y;\r\n//   }\r\n//   set(x, y) {\r\n//     this.x = x;\r\n//     this.y = y;\r\n//   }\r\n//   move(x, y) {\r\n//     this.x += x;\r\n//     this.y += y;\r\n//   }\r\n//   add(v) {\r\n//     return new Vec2(this.x + v.x, this.y + v.y);\r\n//   }\r\n//   sub(v) {\r\n//     return new Vec2(this.x - v.x, this.y - v.y);\r\n//   }\r\n//   mul(s) {\r\n//     return new Vec2(this.x * s, this.y * s);\r\n//   }\r\n//   clone() {\r\n//     return new Vec2(this.x, this.y);\r\n//   }\r\n//   equal(v) {\r\n//     return this.x === v.x && this.y === v.y;\r\n//   }\r\n//   get length() {\r\n//     return Math.sqrt(this.x * this.x + this.y * this.y);\r\n//   }\r\n//   set length(newVal) {\r\n//     const newLength = this.unit.mul(newVal);\r\n//     this.set(newLength.x, newLength.y);\r\n//   }\r\n//   get angle() {\r\n//     return Math.atan2(this.y, this.x);\r\n//   }\r\n//   get unit() {\r\n//     return this.mul(1 / this.length);\r\n//   }\r\n// }"]}